<!DOCTYPE html>
<html lang="en">
<head><meta name="generator" content="Hexo 3.9.0">
<!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-5B6V6ZJ');</script>
    <!-- End Google Tag Manager -->    
        
    <meta charset="utf-8">
    
    <title>Niraj Sonawane</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta property="og:type" content="website">
<meta property="og:title" content="Niraj Sonawane">
<meta property="og:url" content="https://nirajsonawane.github.io/index.html">
<meta property="og:site_name" content="Niraj Sonawane">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Niraj Sonawane">
    

    

    
        <link rel="icon" href="https://raw.githubusercontent.com/nirajsonawane/portfolio/master/images/icon.png">
    

    <link rel="stylesheet" href="/libs/font-awesome5/css/fontawesome.min.css">
    <link rel="stylesheet" href="/libs/font-awesome5/css/fa-brands.min.css">
    <link rel="stylesheet" href="/libs/font-awesome5/css/fa-solid.min.css">
    <link rel="stylesheet" href="/libs/open-sans/styles.css">
    <link rel="stylesheet" href="/libs/source-code-pro/styles.css">

    <link rel="stylesheet" href="/css/style.css">

    <script src="/libs/jquery/2.1.3/jquery.min.js"></script>
    
    
        <link rel="stylesheet" href="/libs/lightgallery/css/lightgallery.min.css">
    
    
        <link rel="stylesheet" href="/libs/justified-gallery/justifiedGallery.min.css">
    
    
        <script type="text/javascript">
(function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-125455524-1', 'auto');
ga('send', 'pageview');

</script>
    
    
    


</head>
</html>
<body>
    <div id="container">
        <header id="header">
    <div id="header-main" class="header-inner">
        <div class="outer">
            <a href="/" id="logo">
                <i class="logo"></i>
                <span class="site-title">Niraj Sonawane</span>
            </a>
            <nav id="main-nav">
                
                    <a class="main-nav-link" href="/.">Home</a>
                
                    <a class="main-nav-link" href="/archives">Archives</a>
                
                    <a class="main-nav-link" href="/tags">Tags</a>
                
                    <a class="main-nav-link" href="/about">About Me</a>
                
            </nav>
            
                
                <nav id="sub-nav">
                    <div class="profile" id="profile-nav">
                        <a id="profile-anchor" href="javascript:;">
                            <img class="avatar" src="https://www.gravatar.com/avatar/8328f9fc834752ead8a75bf4950fa304" />
                            <i class="fas fa-caret-down"></i>
                        </a>
                    </div>
                </nav>
            
            <div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="Search" />
        <button type="submit" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="Type something..." />
            <span class="ins-close ins-selectable"><i class="fas fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'Posts',
            PAGES: 'Pages',
            CATEGORIES: 'Categories',
            TAGS: 'Tags',
            UNTITLED: '(Untitled)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/js/insight.js"></script>

</div>
        </div>
    </div>
    <div id="main-nav-mobile" class="header-sub header-inner">
        <table class="menu outer">
            <tr>
                
                    <td><a class="main-nav-link" href="/.">Home</a></td>
                
                    <td><a class="main-nav-link" href="/archives">Archives</a></td>
                
                    <td><a class="main-nav-link" href="/tags">Tags</a></td>
                
                    <td><a class="main-nav-link" href="/about">About Me</a></td>
                
                <td>
                    
    <div class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="Search" />
    </div>

                </td>
            </tr>
        </table>
    </div>
</header>

        <div class="outer">
            
                

<aside id="profile" class="profile-fixed">
    <div class="inner profile-inner">
        <div class="base-info profile-block">
            <img id="avatar" src="https://www.gravatar.com/avatar/8328f9fc834752ead8a75bf4950fa304?s=128" />
            <h2 id="name">Niraj Sonawane</h2>
            <h3 id="title">I am a Java developer, open-source contributor, student and lifelong learner.</h3>
            <span id="location"><i class="fas fa-map-marker-alt" style="padding-right: 5px"></i>Pune, India</span>
            <a id="follow" target="_blank" href="https://github.com/nirajsonawane">FOLLOW</a>
        </div>
        <div class="article-info profile-block">
            <div class="article-info-block">
                64
                <span>posts</span>
            </div>
            <div class="article-info-block">
                79
                <span>tags</span>
            </div>
        </div>
        
        <div class="profile-block social-links">
            <table>
                <tr>
                    
                    
                    <td>
                        <a href="https://github.com/nirajsonawane/" target="_blank" title="github" class=tooltip>
                            <i class="fab fa-github"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="https://stackoverflow.com/users/320087/niraj-sonawane?tab=profile" target="_blank" title="stack-overflow" class=tooltip>
                            <i class="fab fa-stack-overflow"></i>
                        </a>
                    </td>
                    
                </tr>
            </table>
        </div>
        
    </div>
</aside>

            
            <section id="main">
    <article id="post-From-Monolith-to-Microservices-A-Gradual-Approach-with-Modular-Monolithic-Architecture" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2023/04/16/From-Monolith-to-Microservices-A-Gradual-Approach-with-Modular-Monolithic-Architecture/">From Monolith to Microservices: A Gradual Approach with Modular Monolithic Architecture</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fas fa-calendar-alt"></i>
        <a href="/2023/04/16/From-Monolith-to-Microservices-A-Gradual-Approach-with-Modular-Monolithic-Architecture/">
            <time datetime="2023-04-16T11:25:47.000Z" itemprop="datePublished">2023-04-16</time>
        </a>
    </div>


                        
                        
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link" href="/tags/architecture/">architecture</a>, <a class="tag-link" href="/tags/microservice/">microservice</a>, <a class="tag-link" href="/tags/modular-monolithic/">modular monolithic</a>, <a class="tag-link" href="/tags/monolithic/">monolithic</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <p>As software developers, we are always looking for better ways to build applications that are stable, maintainable, and scalable. In this blog post, I will share my experience with using the Modular Monolithic architecture.</p>
<h3 id="What-is-Modular-Monolithic"><a href="#What-is-Modular-Monolithic" class="headerlink" title="What is Modular Monolithic?"></a>What is Modular Monolithic?</h3><p>Modular Monolithic architecture is an architectural pattern where the application is divided into separate modules that work together as a single, cohesive unit. In this pattern, each module is responsible for a specific set of features and has well-defined interfaces for communicating with other modules. Modules should be created based on business domains to ensure that each module has a clear and specific responsibility.<br><img src="/2023/04/16/From-Monolith-to-Microservices-A-Gradual-Approach-with-Modular-Monolithic-Architecture/Moduler.png"></p>
<h3 id="When-to-Use-Modular-Monolithic-Architecture"><a href="#When-to-Use-Modular-Monolithic-Architecture" class="headerlink" title="When to Use Modular Monolithic Architecture"></a>When to Use Modular Monolithic Architecture</h3><p>Modular Monolithic can be a good choice for quickly getting a project off the ground and adapting to changing business requirements. By starting with a modular monolithic architecture, it is possible to gradually move towards a microservices architecture without the need for a complete rewrite of the codebase.</p>
<p>When building a new system, it is important to focus on understanding the business domain first. You need to identify the business capabilities, processes, and data that the system needs to support. Once you have a clear understanding of the business domain, you can then start thinking about how to partition the system into individual services.</p>
<p>If you are not sure about the domain boundaries, you may want to start with a monolithic architecture and gradually move towards a microservices architecture as you gain more knowledge and experience. A monolithic architecture allows you to build the system as a single, cohesive unit, and it can be easier to refactor and break down into microservices later on. This approach can help you to identify the domain boundaries and dependencies between modules, which can then be used to guide the partitioning of the system into microservices.</p>
<h3 id="Interactions-between-Modules"><a href="#Interactions-between-Modules" class="headerlink" title="Interactions between Modules"></a>Interactions between Modules</h3><p>It is essential to decide on a consistent pattern for how modules should interact with each other. Otherwise, the lack of standardization may lead to code that is difficult to maintain.</p>
<p>In general, there are several common patterns for module interaction:</p>
<p><strong>Function calls:</strong><br>One module calls functions or methods in another module to request some operation or data. However, this can lead to tight coupling, where one module relies heavily on another module’s functions or methods, leading to cascading effects on the calling module. Depending on the number of function calls, the performance of the system may be affected due to the overhead of the function calls.</p>
<p><strong>Events:</strong><br>One module publishes events to a message bus or event stream, and other modules subscribe to these events to react to them. However, when modules rely on events, there may be a lag between the time an event is generated and the time that other modules receive and process the event, leading to eventual consistency issues.</p>
<p><strong>HTTP APIs:</strong><br>Modules expose HTTP APIs that other modules can use to request data or trigger operations. However, since HTTP APIs rely on network calls, the latency of the system may be affected, leading to performance issues. As the system evolves, the APIs may need to change, leading to versioning challenges and backward compatibility issues.</p>
<h3 id="Databases-in-the-Context-of-Modular-Monolithic"><a href="#Databases-in-the-Context-of-Modular-Monolithic" class="headerlink" title="Databases in the Context of Modular Monolithic"></a>Databases in the Context of Modular Monolithic</h3><p>It is essential to avoid allowing data owned by one module to be directly accessed by other modules. If this is not done correctly, we might end up creating a monolithic architecture.<br>In general, we have two patterns for managing persistence state in Modular Monolithic architecture:</p>
<p><strong>Database per module:</strong><br>Each module has its database schema and interacts with it directly. This approach provides isolation between modules and can simplify data management.</p>
<p><strong>Database per bounded context:</strong><br>Each module has its database schema, but the schemas are organized by bounded contexts, which represent different areas of the system’s business domain. This pattern is common</p>
<h3 id="When-to-extract-a-module-as-a-separate-service"><a href="#When-to-extract-a-module-as-a-separate-service" class="headerlink" title="When to extract a module as a separate service:"></a>When to extract a module as a separate service:</h3><p>While modular monolithic architecture provides a flexible and adaptable approach to building applications, there may come a time when one or more modules outgrow the monolithic architecture and need to be extracted as separate services. One common reason for this is when a module becomes too large and requires more resources to scale than can be efficiently handled within the monolithic architecture.</p>
<p>To determine if a module should be extracted as a separate service, consider the following:</p>
<ol>
<li>Is the module experiencing performance issues due to its size or resource requirements?</li>
<li>Are there other modules in the system that depend heavily on the module in question?</li>
<li>Are there clear boundaries around the module’s functionality and business domain that make it suitable   for extraction as a separate service?</li>
<li>Are there benefits to extracting the module as a separate service, such as improved scalability, fault tolerance, or the ability to independently deploy and maintain the module?</li>
</ol>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

    <a data-url="https://nirajsonawane.github.io/2023/04/16/From-Monolith-to-Microservices-A-Gradual-Approach-with-Modular-Monolithic-Architecture/" data-id="clgjbmp0u000hrnus1f19kqxi" class="article-share-link"><i class="fas fa-share"></i>Share</a>
<script>
    (function ($) {
        // Prevent duplicate binding
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fab fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fab fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fab fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fab fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

            
    
        <a href="https://nirajsonawane.github.io/2023/04/16/From-Monolith-to-Microservices-A-Gradual-Approach-with-Modular-Monolithic-Architecture/#comments" class="article-comment-link disqus-comment-count" data-disqus-url="https://nirajsonawane.github.io/2023/04/16/From-Monolith-to-Microservices-A-Gradual-Approach-with-Modular-Monolithic-Architecture/">Comments</a>
    

        </footer>
    </div>
    
</article>



    <article id="post-Launching-Spring-Boot-Apps-on-AWS-ECS-Fargate" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2023/04/09/Launching-Spring-Boot-Apps-on-AWS-ECS-Fargate/">Launching Spring Boot Apps on AWS ECS Fargate</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fas fa-calendar-alt"></i>
        <a href="/2023/04/09/Launching-Spring-Boot-Apps-on-AWS-ECS-Fargate/">
            <time datetime="2023-04-09T19:06:22.000Z" itemprop="datePublished">2023-04-09</time>
        </a>
    </div>


                        
                        
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link" href="/tags/AWS/">AWS</a>, <a class="tag-link" href="/tags/ECR/">ECR</a>, <a class="tag-link" href="/tags/ECS/">ECS</a>, <a class="tag-link" href="/tags/FARGATE/">FARGATE</a>, <a class="tag-link" href="/tags/Spring-Boot/">Spring Boot</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <p>Deploying Spring Boot applications can be challenging, especially when it comes to managing containers in a production environment. However, by using AWS ECS Fargate, you can easily deploy and manage your Spring Boot applications in a scalable and reliable way. In this blog post, we’ll explore the benefits of using AWS ECS Fargate for Spring Boot application deployment, and walk through the steps to prepare your application for deployment on ECS Fargate. We’ll cover creating a Docker image, setting up an ECS Fargate cluster and task definition Let’s get started!</p>
<h4 id="Quick-Overview-about-ECS"><a href="#Quick-Overview-about-ECS" class="headerlink" title="Quick Overview about ECS"></a>Quick Overview about ECS</h4><p><a href="https://aws.amazon.com/ecs" target="_blank" rel="noopener">AWS ECS (Elastic Container Service)</a>  is a fully managed container orchestration service that makes it easy to run, manage, and scale Docker containers on AWS. ECS provides several key concepts for managing containerized applications:</p>
<p><strong>Cluster</strong>: An ECS cluster is a logical grouping of container instances that run your tasks. Each cluster can contain multiple container instances, and each instance can run multiple tasks.</p>
<p><strong>Task</strong>: An ECS task is a running instance of a Docker container that has been launched from a task definition. A task definition is a blueprint for how to run a Docker container, including the Docker image to use, the CPU and memory requirements, the network settings, and more.</p>
<p><strong>Service</strong>: An ECS service is a long-running task that runs continuously in the background, ensuring that your application is always available. A service is defined by a task definition, and it can be scaled up or down based on demand. ECS can automatically manage the load balancing and auto scaling of services.</p>
<p><strong>Batch</strong>: An ECS batch job is a task that is launched for a finite amount of time to perform a specific job, like running a batch script or processing a batch of data. Batch jobs are defined by a job definition, which specifies the Docker image to use, the CPU and memory requirements, and other parameters. Batch jobs can be run on demand or scheduled to run at specific times.</p>
<p>By using ECS, you can easily deploy and manage containerized applications, while taking advantage of AWS features like load balancing, auto scaling, and monitoring.</p>
<p><strong>ECS vs ECS Fargate</strong><br>With ECS, you manage your own EC2 instances that run your containerized applications. </p>
<p><a href="https://aws.amazon.com/fargate/" target="_blank" rel="noopener">AWS ECS Fargate</a> is a serverless container orchestration service that allows you to run containers without having to manage the underlying EC2 instances. With Fargate, AWS takes care of the infrastructure for you, allowing you to focus on running and scaling your containers. Fargate provides the same key concepts as ECS, including clusters, tasks, services, and batch jobs.</p>
<p>The main difference between ECS and ECS Fargate is that with ECS, you manage the EC2 instances that run your containers, whereas with Fargate, AWS manages the instances for you. This makes Fargate a more hands-off approach to container management, and can be beneficial if you don’t want to deal with the operational overhead of managing EC2 instances</p>
<h4 id="let’s-Create-Simple-Spring-Boot-Application-that-we-will-deploy-on-ECS"><a href="#let’s-Create-Simple-Spring-Boot-Application-that-we-will-deploy-on-ECS" class="headerlink" title="let’s Create Simple Spring Boot Application that we will deploy on ECS"></a>let’s Create Simple Spring Boot Application that we will deploy on ECS</h4><img src="/2023/04/09/Launching-Spring-Boot-Apps-on-AWS-ECS-Fargate/ECS.png">
<p><strong>The code for this post is available on Github <a href="https://github.com/nirajsonawane/spring-boot-ecs-Fargate" target="_blank" rel="noopener">here</a></strong></p>
<p><strong>1 Create Simple Spring Boot APP</strong><br>Create Rest API that will return simple String.<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/hello"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Hello Message from ECS Service"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure> </p>
<p><strong>2 Create Docker Image</strong><br>Add Simple Docker file.<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">FROM openjdk:<span class="number">11</span></span><br><span class="line">COPY target/spring-boot-ecs-Fargate-<span class="number">0.0</span>.1-SNAPSHOT.jar spring-boot-ecs-Fargate-<span class="number">0.0</span>.1-SNAPSHOT.jar</span><br><span class="line">ENTRYPOINT [<span class="string">"java"</span>, <span class="string">"-jar"</span>, <span class="string">"/spring-boot-ecs-Fargate-0.0.1-SNAPSHOT.jar"</span>]</span><br></pre></td></tr></table></figure> </p>
<p>Run Below command from root of your project. This will create the docker image with name ‘spring-boot-ecs’<br><code>docker build -t spring-boot-ecs .</code><br>Run Below command to verify docker image is working. You should be able to access API on <a href="http://localhost:8080/hello" target="_blank" rel="noopener">http://localhost:8080/hello</a><br><code>docker run -p 8080:8080 spring-boot-ecs</code>  </p>
<p><strong>3 Create ECR repo for uploading Image</strong><br>AWS ECR (Elastic Container Registry) is a fully-managed Docker container registry that makes it easy to store, manage, and deploy Docker container images. ECR is tightly integrated with ECS, making it easy to store and manage your Docker images for use in ECS tasks.</p>
<p>Here are some key concepts to understand about ECR:</p>
<p><strong>Repository</strong>: An ECR repository is a collection of Docker images with the same name and tag. Each repository has a unique URL that you can use to access the images.</p>
<p><strong>Image</strong>: An ECR image is a Docker image that has been uploaded to an ECR repository. Images can have multiple tags, allowing you to have different versions of the same image.</p>
<p><strong>Registry</strong>: An ECR registry is a collection of ECR repositories that you own. Each AWS account can have one ECR registry.</p>
<p>To use ECR with ECS, you first need to create an ECR repository to store your Docker images. You can then build your Docker image locally, tag it with the ECR repository URL and push it to ECR using the docker push command. Once your Docker image is in ECR, you can reference it in your ECS task definitions and services.</p>
<p>ECR provides a secure and scalable way to manage your Docker images, and it integrates seamlessly with ECS to provide a complete container management solution.</p>
<p>Create an ECR Repo by following step by step guide </p>
<iframe src="https://scribehow.com/embed/Workflow_for_Creating_ECR_Repo_and_uploading_image__G1QYYeJ-RIC1Wc8A7vpBxA" width="100%" height="640" allowfullscreen frameborder="0"></iframe>

<p><strong>Upload Image</strong><br>Create Separate IAM User which will have access to upload image to ECR Repo. You can use AWS CLI for uploading images.<br><code>docker push &lt;your-aws-account.your-aws-repo/spring-boot-ecs:latest</code> </p>
<p><strong>4 Setting up AWS ECS Fargate cluster and task definition</strong> </p>
<p>Here are the steps to follow:<br>Create an ECS cluster, which is a logical grouping of container instances.</p>
<p>Define a task definition for your application, which specifies the Docker image to use, along with any required configuration.</p>
<p>Configure the network settings and security groups for your task definition.</p>
<p>Deploying your Spring Boot application on AWS ECS Fargate</p>
<p>With your ECS cluster and task definition in place, you can now deploy your Spring Boot application on AWS ECS Fargate. Here are the steps to follow:</p>
<p>Create an ECS service for your task definition, which specifies the number of tasks to run, along with the desired load balancing and auto scaling settings.</p>
<iframe src="https://scribehow.com/embed/Create_and_deploy_a_task_definition_on_AWS_Fargate__LS9YPzEfQHy1Mb7hChsF8A" width="100%" height="640" allowfullscreen frameborder="0"></iframe>

<p>Once’s the service is successfully deployed, You can access the API by using Public IP Address of running task</p>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

    <a data-url="https://nirajsonawane.github.io/2023/04/09/Launching-Spring-Boot-Apps-on-AWS-ECS-Fargate/" data-id="clgjbmp11000zrnusclradstm" class="article-share-link"><i class="fas fa-share"></i>Share</a>
<script>
    (function ($) {
        // Prevent duplicate binding
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fab fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fab fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fab fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fab fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

            
    
        <a href="https://nirajsonawane.github.io/2023/04/09/Launching-Spring-Boot-Apps-on-AWS-ECS-Fargate/#comments" class="article-comment-link disqus-comment-count" data-disqus-url="https://nirajsonawane.github.io/2023/04/09/Launching-Spring-Boot-Apps-on-AWS-ECS-Fargate/">Comments</a>
    

        </footer>
    </div>
    
</article>



    <article id="post-Spring-Boot-AWS-RDS-Part-3-Secrets-Manager" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2022/04/27/Spring-Boot-AWS-RDS-Part-3-Secrets-Manager/">Spring Boot &amp; AWS RDS Part 3- Secrets-Manager</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fas fa-calendar-alt"></i>
        <a href="/2022/04/27/Spring-Boot-AWS-RDS-Part-3-Secrets-Manager/">
            <time datetime="2022-04-27T19:40:50.000Z" itemprop="datePublished">2022-04-27</time>
        </a>
    </div>


                        
                        
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link" href="/tags/AWS/">AWS</a>, <a class="tag-link" href="/tags/PostgreSQL/">PostgreSQL</a>, <a class="tag-link" href="/tags/RDS/">RDS</a>, <a class="tag-link" href="/tags/ReadReplica/">ReadReplica</a>, <a class="tag-link" href="/tags/SecretsManager/">SecretsManager</a>, <a class="tag-link" href="/tags/Spring-Boot/">Spring Boot</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <p>The Previous article was about using <a href="https://nirajsonawane.github.io/2022/04/18/Spring-Boot-AWS-RDS/">AWS RDS with Spring Boot</a> &amp; <a href="https://nirajsonawane.github.io/2022/04/24/Spring-Boot-AWS-RDS-Read-Replica-Part-2/">RDS read replicas with Spring Boot</a>. This post is continuation of same topic. In this post i will show you how to access RDS credentials from <a href="https://aws.amazon.com/secrets-manager/" target="_blank" rel="noopener">AWS Secrets Manager</a>.</p>
<p>Managing the application secrets like database credentials, API keys is always a very critical aspect of application security. Now days almost all the enterprise applications have strict constraints on not allowing storing any secrets in plain text. Secrets are also needed to be rotated in certain time intervals. </p>
<p><a href="https://aws.amazon.com/secrets-manager/" target="_blank" rel="noopener">AWS Secrets Manager</a> helps us to easily manage and rotate credentials from a central place. Secrets Manager enables us to easily rotate, manage, and retrieve database credentials, API keys, and other secrets throughout their lifecycle. Users and applications retrieve secrets with a call to Secrets Manager APIs, eliminating the need to hard code sensitive information in plain text. Secrets Manager has the built-in integration with AWS Services like RDS, Redshift  and DocumentDB.</p>
<p><strong>The code for this post is available on Github <a href="https://github.com/nirajsonawane/spring-boot-aws-rds-secretsmanager" target="_blank" rel="noopener">here</a></strong></p>
<h4 id="Creating-Secrets-for-RDS-Instance"><a href="#Creating-Secrets-for-RDS-Instance" class="headerlink" title="Creating Secrets for RDS Instance"></a>Creating Secrets for RDS Instance</h4><p>On AWS Console go to AWS Secrets Manager-&gt;Secrets-&gt;Store a new secret and then select Credentials for Amazon RDS database. And create secret as shown. </p>
<img src="/2022/04/27/Spring-Boot-AWS-RDS-Part-3-Secrets-Manager/secrets-1.png">
<img src="/2022/04/27/Spring-Boot-AWS-RDS-Part-3-Secrets-Manager/secrets-2.png">
<h4 id="Retrieving-secrets-from-secrets-manager"><a href="#Retrieving-secrets-from-secrets-manager" class="headerlink" title="Retrieving secrets from secrets-manager"></a>Retrieving secrets from secrets-manager</h4><p>Now let’s update our Spring Boot app to retrieve the secrets from secrets-manager. Fortunately Spring &amp; AWS team has created very nice and easy to use <a href="https://github.com/aws/aws-secretsmanager-jdbc" target="_blank" rel="noopener">aws-secretsmanager-jdbc</a> library for this. </p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&lt;dependency&gt;</span></span><br><span class="line">    <span class="string">&lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span></span><br><span class="line">    <span class="string">&lt;artifactId&gt;spring-cloud-aws-jdbc&lt;/artifactId&gt;</span></span><br><span class="line">    <span class="string">&lt;version&gt;2.2.6.RELEASE&lt;/version&gt;</span></span><br><span class="line"><span class="string">&lt;/dependency&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="Updating-Data-source-configurations"><a href="#Updating-Data-source-configurations" class="headerlink" title="Updating Data  source configurations"></a>Updating Data  source configurations</h4><p>Now we have to update data source configurations in application.properties so that the application can pick up the database credentials.</p>
<figure class="highlight yaml"><figcaption><span>configuration without secret manager</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">spring.datasource.url=jdbc:postgresql://&lt;database-endpoint-url&gt;:&lt;port&gt;/&lt;database&gt;</span> </span><br><span class="line"><span class="string">spring.datasource.username=admin1</span></span><br><span class="line"><span class="string">spring.datasource.password=Admin123</span></span><br></pre></td></tr></table></figure>
<figure class="highlight yaml"><figcaption><span>configuration with secret manager</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">spring.datasource.url=jdbc-secretsmanager:postgresql://&lt;database-endpoint-url&gt;:&lt;port&gt;/&lt;database&gt;</span> </span><br><span class="line"><span class="string">spring.datasource.username=dev/test-rds-secret-1</span></span><br><span class="line"><span class="string">spring.datasource.driver-class-name=com.amazonaws.secretsmanager.sql.AWSSecretsManagerPostgreSQLDriver</span></span><br></pre></td></tr></table></figure>
<p>Observe that<code>JDBC URL</code> prefix changed to <code>jdbc-secretmanager</code>.<br>secret name is used username.<br>The driver class is from <code>spring-cloud-aws-jdbc</code>.</p>
<figure class="highlight java"><figcaption><span>Other driver classes</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">com.amazonaws.secretsmanager.sql.AWSSecretsManagerMySQLDriver</span><br><span class="line">com.amazonaws.secretsmanager.sql.AWSSecretsManagerOracleDriver</span><br><span class="line">com.amazonaws.secretsmanager.sql.AWSSecretsManagerMSSQLServerDriver</span><br></pre></td></tr></table></figure>
<p>Now if you Run the application, Application should connect to database.  </p>
<p><strong>Note</strong><br>For running the application <strong>locally</strong>, AWS Profile should have been configured correctly &amp; user should access to read secrets from secretsmanager.<br> <figure class="highlight yaml"><figcaption><span>config credentials</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">[default]</span></span><br><span class="line"><span class="string">aws_access_key_id</span> <span class="string">=</span> <span class="string">XXXXX</span></span><br><span class="line"><span class="string">aws_secret_access_key</span> <span class="string">=</span> <span class="string">XXXXX</span></span><br></pre></td></tr></table></figure> </p>
<h4 id="How-the-magic-happens"><a href="#How-the-magic-happens" class="headerlink" title="How the magic happens?"></a>How the magic happens?</h4><p>Magic fo connecting to the database is done by the the JDBC driver class provided by the  <code>aws-secretsmanager-jdbc</code>. When the application request the connection the wrapper class <code>AWSSecretsManagerPostgreSQLDriver</code> makes and API call to Secrets Manager to retrieve the credentials.</p>
<h4 id="Whats-happens-when-secrets-are-Rotated"><a href="#Whats-happens-when-secrets-are-Rotated" class="headerlink" title="Whats happens when secrets are Rotated?"></a>Whats happens when secrets are Rotated?</h4><p>The <code>aws-secretsmanager-jdbc</code> library does not calls AWS Secrets Manager API every time when connection is requested.<br>As accessing Secrets Manager API is expensive hence it uses cache. The cache policy is Least Recently Used (LRU), so when the cache must discard a secret, it discards the least recently used secret. By default, the cache refreshes secrets every hour. </p>
<p>When the cached has not expired but the Secrets in AWS Secrets Manager is rotated or changed,<br>Driver uses fallback mechanism. If the database returns an error for the wrong username/password, Driver class makes an fresh API to AWS Secrets Manager to get the new credentials.</p>
<p><strong>The code for this post is available on Github <a href="https://github.com/nirajsonawane/spring-boot-aws-rds-secretsmanager" target="_blank" rel="noopener">here</a></strong></p>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

    <a data-url="https://nirajsonawane.github.io/2022/04/27/Spring-Boot-AWS-RDS-Part-3-Secrets-Manager/" data-id="clgjbmp17001drnusdda5ph03" class="article-share-link"><i class="fas fa-share"></i>Share</a>
<script>
    (function ($) {
        // Prevent duplicate binding
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fab fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fab fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fab fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fab fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

            
    
        <a href="https://nirajsonawane.github.io/2022/04/27/Spring-Boot-AWS-RDS-Part-3-Secrets-Manager/#comments" class="article-comment-link disqus-comment-count" data-disqus-url="https://nirajsonawane.github.io/2022/04/27/Spring-Boot-AWS-RDS-Part-3-Secrets-Manager/">Comments</a>
    

        </footer>
    </div>
    
</article>



    <article id="post-Spring-Boot-AWS-RDS-Read-Replica-Part-2" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2022/04/24/Spring-Boot-AWS-RDS-Read-Replica-Part-2/">Spring Boot &amp; AWS RDS Part 2 - Read Replicas</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fas fa-calendar-alt"></i>
        <a href="/2022/04/24/Spring-Boot-AWS-RDS-Read-Replica-Part-2/">
            <time datetime="2022-04-24T10:14:14.000Z" itemprop="datePublished">2022-04-24</time>
        </a>
    </div>


                        
                        
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link" href="/tags/AWS/">AWS</a>, <a class="tag-link" href="/tags/PostgreSQL/">PostgreSQL</a>, <a class="tag-link" href="/tags/RDS/">RDS</a>, <a class="tag-link" href="/tags/ReadReplica/">ReadReplica</a>, <a class="tag-link" href="/tags/Spring-Boot/">Spring Boot</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <img src="/2022/04/24/Spring-Boot-AWS-RDS-Read-Replica-Part-2/iam.jpg">
<p>In <a href="https://nirajsonawane.github.io/2022/04/18/Spring-Boot-AWS-RDS/">Previous post</a> we discuss, How to use spring boot to access AWS RDS service. This post is continuation of same topic and we will explore, How we can configure &amp; use ReadReplicas.</p>
<h4 id="What-is-Database-Read-Replicas"><a href="#What-is-Database-Read-Replicas" class="headerlink" title="What is Database Read Replicas?"></a>What is Database Read Replicas?</h4><p>In General read replica is a copy of the primary database instance and it automatically reflects changes made in primary database in almost real time. Read Replicas can improve the performance of read-heavy database workloads by offloading read workload from primary instance.</p>
<h4 id="How-AWS-RDS-read-replica-works"><a href="#How-AWS-RDS-read-replica-works" class="headerlink" title="How AWS RDS read replica works?"></a>How AWS RDS read replica works?</h4><p>Amazon RDS uses the MariaDB, Microsoft SQL Server, MySQL, Oracle, and PostgreSQL DB engines’ built-in replication functionality to create a read replica. Any Updates made to the primary DB instance are asynchronously copied to the read replica. </p>
<img src="/2022/04/24/Spring-Boot-AWS-RDS-Read-Replica-Part-2/read-and-standby-replica.png">
<p>AWS allows to create read replicas in same availability zone or in different availability zone. It Also allows to create read replicas in different regions. <strong>Creating up to 5 read replicas are allowed.</strong> </p>
<h4 id="Why-to-use-read-replica"><a href="#Why-to-use-read-replica" class="headerlink" title="Why to use read replica?"></a>Why to use read replica?</h4><ol>
<li>Read replicas can significantly improve the performance by redirecting read traffic to one or more read replicas.</li>
<li>Read replicas are Ideal for implementing Business reporting or data warehousing work loads, Without impacting normal business flows.</li>
<li><p>In some cases read replica can be used for implementing disaster recovery. Read replicas can be promoted as primary database instance. </p>
<h4 id="How-to-create-read-replicas-in-AWS-Console"><a href="#How-to-create-read-replicas-in-AWS-Console" class="headerlink" title="How to create read replicas in AWS Console?"></a>How to create read replicas in AWS Console?</h4><p>While creating a read replicas we need to specify an existing DB instance as the source. Then Amazon RDS takes a snapshot of the source instance and creates a read-only instance from the snapshot. The read replica operates as a DB instance that allows only read-only connections.<br>Applications connect to a read replica the same way they do to any DB instance. </p>
</li>
</ol>
<p>On AWS Console choose the DB instance that you want to use as the source for a read replica.<br>Then Go to action, choose Create read replica. Then Follow the same steps explained In <a href="https://nirajsonawane.github.io/2022/04/18/Spring-Boot-AWS-RDS/">Previous post</a> </p>
<p>All the data from the main table will also be available in replicated instance. We can verify the data by connecting to replicated instance using PGAdmin or any other similar tool.<br><img src="/2022/04/24/Spring-Boot-AWS-RDS-Read-Replica-Part-2/rds.png"><br><img src="/2022/04/24/Spring-Boot-AWS-RDS-Read-Replica-Part-2/admin.png"></p>
<h4 id="How-to-use-read-replicas-with-Spring-Boot-App"><a href="#How-to-use-read-replicas-with-Spring-Boot-App" class="headerlink" title="How to use read replicas with Spring Boot App"></a>How to use read replicas with Spring Boot App</h4><p>In <a href="https://nirajsonawane.github.io/2022/04/18/Spring-Boot-AWS-RDS/">Previous post</a> we used  <code>spring-boot-starter-data-jpa</code>, To use the full power for read replicas , In this example we will use <strong>Spring Cloud AWS JDBC</strong> as it provides some useful features.</p>
<ol>
<li>Spring cloud aws automatically detects the read-replica instance and If the read replica support is enabled, It will automatically send the requests to e replica instance. As an application developer we do not have to configure multiple data sources.    </li>
<li>Spring cloud aws does the Automatic retry incase of database failure. It attempts to send the same request to different availability zone.</li>
<li><p>As an application developer, We do not need to worry about how many read replicas are configured.</p>
<h4 id="Setting-up-Spring-Boot-App"><a href="#Setting-up-Spring-Boot-App" class="headerlink" title="Setting up Spring Boot App"></a>Setting up Spring Boot App</h4><p>Let’s create simple small Spring Boot app that will interact with primary database and read replicas.<br>Apart form other needed dependency, We need to add  <code>spring-cloud-aws-jdbc</code> as dependency</p>
</li>
</ol>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&lt;dependency&gt;</span></span><br><span class="line">    <span class="string">&lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span></span><br><span class="line">    <span class="string">&lt;artifactId&gt;spring-cloud-aws-jdbc&lt;/artifactId&gt;</span></span><br><span class="line">    <span class="string">&lt;version&gt;2.2.6.RELEASE&lt;/version&gt;</span></span><br><span class="line"><span class="string">&lt;/dependency&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>The code for this post is available on Github <a href="https://github.com/nirajsonawane/spring-boot-aws-postgresql-read-replica" target="_blank" rel="noopener">here</a></strong></p>
<h4 id="Configuring-data-source"><a href="#Configuring-data-source" class="headerlink" title="Configuring data source"></a>Configuring data source</h4><p>The data sources can be configured using the Spring Boot configuration files. Because of the dynamic number of data sources inside one application, the Spring Boot properties must be configured for each data source.</p>
<img src="/2022/04/24/Spring-Boot-AWS-RDS-Read-Replica-Part-2/1.png">
<figure class="highlight yaml"><figcaption><span>data source configuration properties</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">cloud.aws.rds.&lt;DB-Instance-ID&gt;.username=admin1</span></span><br><span class="line"><span class="string">cloud.aws.rds.&lt;DB-Instance-ID&gt;.password=Admin123</span></span><br><span class="line"><span class="string">cloud.aws.rds.&lt;DB-Instance-ID&gt;.databaseName=employee</span></span><br></pre></td></tr></table></figure>
<h4 id="How-to-enable-read-replica"><a href="#How-to-enable-read-replica" class="headerlink" title="How to  enable read-replica"></a>How to  enable read-replica</h4><figure class="highlight yaml"><figcaption><span>enable read replica</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">cloud.aws.rds.employee-db.readReplicaSupport=true</span></span><br></pre></td></tr></table></figure>
<h4 id="How-To-redirect-read-traffic-to-read-replica-instance"><a href="#How-To-redirect-read-traffic-to-read-replica-instance" class="headerlink" title="How To redirect read traffic to read replica instance"></a>How To redirect read traffic to read replica instance</h4><p>For redirecting traffic to replicated instance we just need to use Transactions and set <code>Transactional</code> property  as <code>readOnly = true</code><br><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">@Service</span></span><br><span class="line"><span class="string">@RequiredArgsConstructor</span></span><br><span class="line"><span class="string">public</span> <span class="string">class</span> <span class="string">EmployeeService</span> <span class="string">&#123;</span></span><br><span class="line">       </span><br><span class="line">       <span class="string">private</span> <span class="string">final</span> <span class="string">EmployeeRepository</span> <span class="string">repository;</span></span><br><span class="line"></span><br><span class="line">       <span class="string">@Transactional</span></span><br><span class="line">       <span class="string">public</span> <span class="string">void</span> <span class="string">saveEmployeeToDatabase(Employee</span> <span class="string">employee)&#123;</span></span><br><span class="line">           <span class="string">repository.save(employee);</span></span><br><span class="line">       <span class="string">&#125;</span></span><br><span class="line"></span><br><span class="line">        <span class="string">@Transactional(readOnly</span> <span class="string">=</span> <span class="literal">true</span><span class="string">)</span></span><br><span class="line">        <span class="string">public</span> <span class="string">List&lt;Employee&gt;</span> <span class="string">findAll()&#123;</span></span><br><span class="line">            <span class="string">return</span> <span class="string">repository.findAll();</span></span><br><span class="line">        <span class="string">&#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure></p>
<h4 id="Write-work-load-and-replication"><a href="#Write-work-load-and-replication" class="headerlink" title="Write work load and replication"></a>Write work load and replication</h4><p>All Write transactions will be redirected to the primary DB Instance and AWS will handle the replication asynchronously without impacting the performance of primary DB Instance.  </p>
<h4 id="Points-to-keep-in-mind-before-using-read-replicas"><a href="#Points-to-keep-in-mind-before-using-read-replicas" class="headerlink" title="Points to keep in mind before using read replicas"></a>Points to keep in mind before using read replicas</h4><p>Read-replica feature of RDS can increase throughput and performance but replication is not exactly realtime. There will be some lag in coping with data from primary instance to replicated instance and Read replica might return outdated data in some scenarios.     </p>
<p><strong>The code for this post is available on Github <a href="https://github.com/nirajsonawane/spring-boot-aws-postgresql-read-replica" target="_blank" rel="noopener">here</a></strong></p>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

    <a data-url="https://nirajsonawane.github.io/2022/04/24/Spring-Boot-AWS-RDS-Read-Replica-Part-2/" data-id="clgjbmp17001crnus3fr2p9ky" class="article-share-link"><i class="fas fa-share"></i>Share</a>
<script>
    (function ($) {
        // Prevent duplicate binding
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fab fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fab fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fab fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fab fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

            
    
        <a href="https://nirajsonawane.github.io/2022/04/24/Spring-Boot-AWS-RDS-Read-Replica-Part-2/#comments" class="article-comment-link disqus-comment-count" data-disqus-url="https://nirajsonawane.github.io/2022/04/24/Spring-Boot-AWS-RDS-Read-Replica-Part-2/">Comments</a>
    

        </footer>
    </div>
    
</article>



    <article id="post-Spring-Boot-AWS-RDS" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2022/04/18/Spring-Boot-AWS-RDS/">Spring Boot &amp; AWS RDS - Part 1</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fas fa-calendar-alt"></i>
        <a href="/2022/04/18/Spring-Boot-AWS-RDS/">
            <time datetime="2022-04-18T09:56:34.000Z" itemprop="datePublished">2022-04-18</time>
        </a>
    </div>


                        
                        
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link" href="/tags/AWS/">AWS</a>, <a class="tag-link" href="/tags/PostgreSQL/">PostgreSQL</a>, <a class="tag-link" href="/tags/RDS/">RDS</a>, <a class="tag-link" href="/tags/Spring-Boot/">Spring Boot</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <h3 id="What-is-AWS-RDS"><a href="#What-is-AWS-RDS" class="headerlink" title="What is AWS RDS?"></a>What is AWS RDS?</h3><p>AWS RDS is a collection of managed services that makes it simple to set up, operate, and scale databases in the cloud. AWS RDS provides multiple DB Engines options like MySQL, PostgreSQL,MariaDB, Oracle SQL Server.</p>
<p>As Amazon RDS handles routine database tasks such as provisioning, patching, backup, recovery, failure detection, and repair. This brings a lot of convenience to RDS users and provides. RDS also provides other features like replication, enhance availability and reliability.</p>
<p>In this article we will examine how to use Spring boot to access AWS RDS PostgreSQL. Amazon RDS for PostgreSQL provides access to the capabilities of the familiar PostgreSQL database engine.</p>
<h3 id="Creating-PostgreSQL-DB-Instance-on-AWS"><a href="#Creating-PostgreSQL-DB-Instance-on-AWS" class="headerlink" title="Creating PostgreSQL DB Instance on AWS"></a>Creating PostgreSQL DB Instance on AWS</h3><p>Go to RDS-&gt;Databases-&gt;Create Database  for creating new database instance. Select PostgreSQL as engine type.<br>For this demo i am using below setting. (These configurations are not recommended for production usage) </p>
<ol>
<li>Free tier, </li>
<li>DB instance identifier : employee-db</li>
<li>Credential: Master username</li>
<li>VPC : Default </li>
<li>Public Access:True</li>
<li>Security Group:Default</li>
<li>Initial database name:employee</li>
</ol>
<img src="/2022/04/18/Spring-Boot-AWS-RDS/1.png">
<img src="/2022/04/18/Spring-Boot-AWS-RDS/2.png">
<img src="/2022/04/18/Spring-Boot-AWS-RDS/3.png">
<p><strong>Note</strong><br>Only specifying Public Access:True for your Databases might not work. The Security group should allow Inbound traffic from your IP address or All IP address.<br><img src="/2022/04/18/Spring-Boot-AWS-RDS/7.png"> </p>
<p>Onces the database is ready, Note the <strong>Endpoint url</strong>   which we will use as <code>spring.datasource.url</code><br><img src="/2022/04/18/Spring-Boot-AWS-RDS/5.png"></p>
<h3 id="Setting-up-Spring-Boot-Project"><a href="#Setting-up-Spring-Boot-Project" class="headerlink" title="Setting up Spring Boot Project"></a>Setting up Spring Boot Project</h3><p>Let’s create simple small Spring Boot app that will interact with RDS. </p>
<p>We do not need any AWS specific dependancy, Only JPA,spring-web &amp; postgresql dependancy are needed.<br><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&lt;dependency&gt;</span></span><br><span class="line">	<span class="string">&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span></span><br><span class="line">	<span class="string">&lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;</span></span><br><span class="line"><span class="string">&lt;/dependency&gt;</span></span><br><span class="line"><span class="string">&lt;dependency&gt;</span></span><br><span class="line">	<span class="string">&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span></span><br><span class="line">	<span class="string">&lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;</span></span><br><span class="line"><span class="string">&lt;/dependency&gt;</span></span><br><span class="line"><span class="string">&lt;dependency&gt;</span></span><br><span class="line">	<span class="string">&lt;groupId&gt;org.postgresql&lt;/groupId&gt;</span></span><br><span class="line">	<span class="string">&lt;artifactId&gt;postgresql&lt;/artifactId&gt;</span></span><br><span class="line">	<span class="string">&lt;scope&gt;runtime&lt;/scope&gt;</span></span><br><span class="line"><span class="string">&lt;/dependency&gt;</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight yaml"><figcaption><span>Data source configurations</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">spring.datasource.url=jdbc:postgresql://&lt;database-endpoint-url&gt;:&lt;port&gt;/&lt;database&gt;</span> </span><br><span class="line"><span class="string">spring.datasource.username=admin1</span></span><br><span class="line"><span class="string">spring.datasource.password=Admin123</span></span><br><span class="line"><span class="string">spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect</span></span><br><span class="line"><span class="string">spring.jpa.hibernate.ddl-auto=update</span></span><br><span class="line"><span class="string">spring.jpa.hibernate.show-sql=true</span></span><br></pre></td></tr></table></figure>
<p>Onces the database connection is done, We can simply use the JAP Repository to interact with database.</p>
<figure class="highlight java"><figcaption><span>Controller</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/employee"</span>)</span><br><span class="line"><span class="meta">@RequiredArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EmployeeController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> EmployeeRepository repository;</span><br><span class="line">    <span class="meta">@PostMapping</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ResponseEntity <span class="title">createEmployee</span><span class="params">(@RequestBody CreateEmployeeRequest request)</span> </span>&#123;</span><br><span class="line">        repository.save(<span class="keyword">new</span> Employee(request.getId(), request.getFirstName(), request.getLastName()));</span><br><span class="line">        <span class="keyword">return</span> ResponseEntity</span><br><span class="line">                .status(HttpStatus.CREATED)</span><br><span class="line">                .build();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@GetMapping</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Employee&gt; <span class="title">getAllEmployee</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> repository.findAll();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><figcaption><span>Entity And Repository</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Employee</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="keyword">private</span> UUID id;</span><br><span class="line">    <span class="keyword">private</span> String firstName;</span><br><span class="line">    <span class="keyword">private</span> String lastName;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">EmployeeRepository</span> <span class="keyword">extends</span> <span class="title">JpaRepository</span>&lt;<span class="title">Employee</span>, <span class="title">UUID</span>&gt; </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>The code for this post is available on Github <a href="https://github.com/nirajsonawane/spring-boot-aws-postgresql" target="_blank" rel="noopener">here</a></strong></p>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

    <a data-url="https://nirajsonawane.github.io/2022/04/18/Spring-Boot-AWS-RDS/" data-id="clgjbmp18001frnusds8zwwvt" class="article-share-link"><i class="fas fa-share"></i>Share</a>
<script>
    (function ($) {
        // Prevent duplicate binding
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fab fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fab fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fab fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fab fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

            
    
        <a href="https://nirajsonawane.github.io/2022/04/18/Spring-Boot-AWS-RDS/#comments" class="article-comment-link disqus-comment-count" data-disqus-url="https://nirajsonawane.github.io/2022/04/18/Spring-Boot-AWS-RDS/">Comments</a>
    

        </footer>
    </div>
    
</article>



    <article id="post-Spring-Boot-with-AWS-S3" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2021/05/16/Spring-Boot-with-AWS-S3/">Spring Boot With AWS S3</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fas fa-calendar-alt"></i>
        <a href="/2021/05/16/Spring-Boot-with-AWS-S3/">
            <time datetime="2021-05-16T20:17:01.000Z" itemprop="datePublished">2021-05-16</time>
        </a>
    </div>


                        
                        
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link" href="/tags/AWS/">AWS</a>, <a class="tag-link" href="/tags/S3/">S3</a>, <a class="tag-link" href="/tags/Spring-Boot/">Spring Boot</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <p>In <a href="https://nirajsonawane.github.io/2021/05/09/Spring-Boot-with-AWS-sqs/">previous post</a> we discuss, How to use spring boot to access AWS SQS service. In this article we will examine how to use Spring boot to access <strong>AWS S3</strong>.</p>
<p><strong>Spring Cloud</strong> provides convenient way to interact with AWS S3 service. With the help of spring cloud S3 support we can use all well-known Spring Boot features. It also offers multiple useful features compare to SDK provided by AWS.</p>
<p><strong>The code for this post is available on Github <a href="https://github.com/nirajsonawane/spring-boot-s3-poc.git" target="_blank" rel="noopener">here</a></strong></p>
<h4 id="Using-Spring-cloud"><a href="#Using-Spring-cloud" class="headerlink" title="Using Spring cloud"></a>Using Spring cloud</h4><figure class="highlight yaml"><figcaption><span>To use S3 support we just need to add below dependancy</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&lt;dependency&gt;</span></span><br><span class="line">    <span class="string">&lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span></span><br><span class="line">    <span class="string">&lt;artifactId&gt;spring-cloud-starter-aws&lt;/artifactId&gt;</span></span><br><span class="line"><span class="string">&lt;/dependency&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>Providing AWS credential and SDK configurations</strong><br><figure class="highlight yaml"><figcaption><span>In order to make calls to the AWS Services the credentials must be configured for the the Amazon SDK. In order to access S3 service we can configure access key and secret key using yaml or properties files</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">document:</span></span><br><span class="line"><span class="attr">  bucket-name:</span> <span class="string">spring-boot-s3-poc</span></span><br><span class="line"><span class="attr">cloud:</span></span><br><span class="line"><span class="attr">  aws:</span></span><br><span class="line"><span class="attr">    region:</span></span><br><span class="line"><span class="attr">      static:</span> <span class="string">us-east-1</span></span><br><span class="line"><span class="attr">      auto:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">    credentials:</span></span><br><span class="line"><span class="attr">      access-key:</span> <span class="string">XXX</span></span><br><span class="line"><span class="attr">      secret-key:</span> <span class="string">XXXXX</span></span><br></pre></td></tr></table></figure></p>
<p><strong>Creating AmazonS3 Client bean</strong><br><code>AmazonS3 Client</code> bean can be use to perform different operation on AWS S3 service.<br><figure class="highlight java"><figcaption><span>AmazonS3 Client Configuration</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Config</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;cloud.aws.credentials.access-key&#125;"</span>)</span><br><span class="line">    <span class="keyword">private</span> String awsAccessKey;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;cloud.aws.credentials.secret-key&#125;"</span>)</span><br><span class="line">    <span class="keyword">private</span> String awsSecretKey;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;cloud.aws.region.static&#125;"</span>)</span><br><span class="line">    <span class="keyword">private</span> String region;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Primary</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> AmazonS3 <span class="title">amazonS3Client</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> AmazonS3ClientBuilder</span><br><span class="line">                .standard()</span><br><span class="line">                .withRegion(region)</span><br><span class="line">                .withCredentials(<span class="keyword">new</span> AWSStaticCredentialsProvider(</span><br><span class="line">                        <span class="keyword">new</span> BasicAWSCredentials(awsAccessKey, awsSecretKey)))</span><br><span class="line">                .build();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="Find-all-objects-in-bucket"><a href="#Find-all-objects-in-bucket" class="headerlink" title="Find all objects in bucket"></a>Find all objects in bucket</h3><figure class="highlight java"><figcaption><span>listObjectsV2 method can be use to get all object keys from the bucket</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;String&gt; <span class="title">getAllDocuments</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> amazonS3.listObjectsV2(bucketName).getObjectSummaries().stream()</span><br><span class="line">                .map(S3ObjectSummary::getKey)</span><br><span class="line">                .collect(Collectors.toList());</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h3 id="Upload-object-to-S3-bucket"><a href="#Upload-object-to-S3-bucket" class="headerlink" title="Upload object to S3 bucket"></a>Upload object to S3 bucket</h3><p>We can  use <code>putObject</code> method on our AmazonS3 client bean to upload object  in S3 bucket. It provides multiple overloaded methods to upload object as File, String, InputStream etc.<br>lets take example of uploading <code>MultipartFile</code> to S3 bucket. </p>
<figure class="highlight java"><figcaption><span>Uploading MultipartFile to S3 bucket</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> ResponseEntity <span class="title">uploadDocument</span><span class="params">(@RequestParam(value = <span class="string">"file"</span>)</span> MultipartFile file) <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">       String tempFileName = UUID.randomUUID() + file.getName();</span><br><span class="line">       File tempFile = <span class="keyword">new</span> File(System.getProperty(<span class="string">"java.io.tmpdir"</span>) + <span class="string">"/"</span> + tempFileName);</span><br><span class="line">       file.transferTo(tempFile); <span class="comment">// Convert multipart file to File</span></span><br><span class="line">       String key UID.randomUUID() + file.getName() <span class="comment">// unique key  for the file</span></span><br><span class="line">       amazonS3.putObject(bucketName, key, tempFile); <span class="comment">// Upload file </span></span><br><span class="line">       tempFile.deleteOnExit(); <span class="comment">//delete temp file </span></span><br><span class="line">       <span class="keyword">return</span> ResponseEntity.created(URI.create(tempFileName)).build();</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<h3 id="Download-object-from-S3-bucket"><a href="#Download-object-from-S3-bucket" class="headerlink" title="Download object from S3 bucket"></a>Download object from S3 bucket</h3><p>We can  use <code>getObject</code> method on our AmazonS3 client bean to get object from S3 bucket. <code>getObject</code> returns an <code>S3Object</code><br>which can be converted to ByteArrayResource .<br><figure class="highlight java"><figcaption><span>Download object from S3 bucket</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping</span>(<span class="string">"/&#123;fileName&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ResponseEntity&lt;ByteArrayResource&gt; <span class="title">downloadFile</span><span class="params">(@PathVariable String fileName)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        S3Object data = amazonS3.getObject(bucketName, fileName); <span class="comment">// fileName is key which is used while uploading the object </span></span><br><span class="line">        S3ObjectInputStream objectContent = data.getObjectContent();</span><br><span class="line">        <span class="keyword">byte</span>[] bytes = IOUtils.toByteArray(objectContent);</span><br><span class="line">        ByteArrayResource resource = <span class="keyword">new</span> ByteArrayResource(bytes);</span><br><span class="line">        objectContent.close();</span><br><span class="line">        <span class="keyword">return</span> ResponseEntity</span><br><span class="line">                .ok()</span><br><span class="line">                .contentLength(bytes.length)</span><br><span class="line">                .header(<span class="string">"Content-type"</span>, <span class="string">"application/octet-stream"</span>)</span><br><span class="line">                .header(<span class="string">"Content-disposition"</span>, <span class="string">"attachment; filename=\""</span> + fileName + <span class="string">"\""</span>)</span><br><span class="line">                .body(resource);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="Deleting-object-from-S3-bucket"><a href="#Deleting-object-from-S3-bucket" class="headerlink" title="Deleting object from S3 bucket"></a>Deleting object from S3 bucket</h3><p>We can  use <code>deleteObject</code> method on our AmazonS3 client bean to delete object from bucket.<br><figure class="highlight java"><figcaption><span>Delete Object</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@DeleteMapping</span>(<span class="string">"/&#123;fileName&#125;"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> ResponseEntity <span class="title">deleteDocument</span><span class="params">(@PathVariable String fileName)</span> </span>&#123;</span><br><span class="line">    log.info(<span class="string">"Deleting file &#123;&#125;"</span>, fileName); </span><br><span class="line">    amazonS3.deleteObject(bucketName, fileName); <span class="comment">// fileName is key which is used while uploading the object </span></span><br><span class="line">    <span class="keyword">return</span> ResponseEntity.ok().build();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="Creating-presigned-url-for-accessing-objects-for-limited-time"><a href="#Creating-presigned-url-for-accessing-objects-for-limited-time" class="headerlink" title="Creating presigned-url for accessing objects for limited time."></a>Creating presigned-url for accessing objects for limited time.</h3><p>We can  use <code>generatePresignedUrl</code> method on our AmazonS3 client bean to generate PresignedUrl which will be valid till provided time.<br><figure class="highlight java"><figcaption><span>get presignedUrl</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping</span>(<span class="string">"/presigned-url/&#123;fileName&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">presignedUrl</span><span class="params">(@PathVariable String fileName)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> amazonS3</span><br><span class="line">               .generatePresignedUrl(bucketName, fileName, convertToDateViaInstant(LocalDate.now().plusDays(<span class="number">1</span>)))</span><br><span class="line">               .toString();<span class="comment">// URL will be valid for 24hrs</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<p>Note:<br>On application startup, you might see exception related to Metadata or RegistryFactoryBean. You need to exclude some auto configuration. You can find more details<br><a href="https://stackoverflow.com/a/67409356/320087" target="_blank" rel="noopener">https://stackoverflow.com/a/67409356/320087</a><br><figure class="highlight yaml"><figcaption><span>exclude autoconfigure</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> </span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">  autoconfigure:</span></span><br><span class="line"><span class="attr">    exclude:</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">org.springframework.cloud.aws.autoconfigure.context.ContextInstanceDataAutoConfiguration</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">org.springframework.cloud.aws.autoconfigure.context.ContextStackAutoConfiguration</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">org.springframework.cloud.aws.autoconfigure.context.ContextRegionProviderAutoConfiguration</span></span><br></pre></td></tr></table></figure></p>
<p><strong>The code for this post is available on Github <a href="https://github.com/nirajsonawane/spring-boot-s3-poc.git" target="_blank" rel="noopener">here</a></strong></p>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

    <a data-url="https://nirajsonawane.github.io/2021/05/16/Spring-Boot-with-AWS-S3/" data-id="clgjbmp18001grnus2f8vyqnm" class="article-share-link"><i class="fas fa-share"></i>Share</a>
<script>
    (function ($) {
        // Prevent duplicate binding
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fab fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fab fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fab fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fab fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

            
    
        <a href="https://nirajsonawane.github.io/2021/05/16/Spring-Boot-with-AWS-S3/#comments" class="article-comment-link disqus-comment-count" data-disqus-url="https://nirajsonawane.github.io/2021/05/16/Spring-Boot-with-AWS-S3/">Comments</a>
    

        </footer>
    </div>
    
</article>



    <article id="post-Spring-Boot-with-AWS-sqs" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2021/05/09/Spring-Boot-with-AWS-sqs/">Spring Boot With AWS SQS</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fas fa-calendar-alt"></i>
        <a href="/2021/05/09/Spring-Boot-with-AWS-sqs/">
            <time datetime="2021-05-09T15:09:52.000Z" itemprop="datePublished">2021-05-09</time>
        </a>
    </div>


                        
                        
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link" href="/tags/AWS/">AWS</a>, <a class="tag-link" href="/tags/SQS/">SQS</a>, <a class="tag-link" href="/tags/Spring-Boot/">Spring Boot</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <p><strong>Spring Cloud</strong> messaging support provides a convenient way to interact with AWS SQS service, With the help of spring cloud messaging support we can use all well-known Spring Boot features. It also offers multiple useful features compare to SDK provided by AWS.</p>
<p><strong>The code for this post is available on Github <a href="https://github.com/nirajsonawane/aws-sqs-spring-boot-poc.git" target="_blank" rel="noopener">here</a></strong></p>
<h4 id="Create-a-standard-AWS-SQS-queue"><a href="#Create-a-standard-AWS-SQS-queue" class="headerlink" title="Create a standard AWS SQS queue"></a>Create a standard AWS SQS queue</h4><p>Navigate to aws consol -&gt; Simple queue service -&gt; create queue. Then select standard queue and provide name to queue.Click on create queue.<br><img src="/2021/05/09/Spring-Boot-with-AWS-sqs/1.png"></p>
<p><strong>Create IAM Role and IAM Group</strong>, Which will have access to our queue. </p>
<img src="/2021/05/09/Spring-Boot-with-AWS-sqs/3.png">
<img src="/2021/05/09/Spring-Boot-with-AWS-sqs/2.png">
<h4 id="Using-Spring-cloud-messaging"><a href="#Using-Spring-cloud-messaging" class="headerlink" title="Using Spring cloud messaging"></a>Using Spring cloud messaging</h4><figure class="highlight yaml"><figcaption><span>The Spring Cloud AWS messaging module comes as a standalone module and can be imported with the following dependency</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&lt;dependency&gt;</span></span><br><span class="line">    <span class="string">&lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span></span><br><span class="line">    <span class="string">&lt;artifactId&gt;spring-cloud-starter-aws-messaging&lt;/artifactId&gt;</span></span><br><span class="line"><span class="string">&lt;/dependency&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>Providing AWS credential and SDK configurations</strong><br><figure class="highlight yaml"><figcaption><span>In order to make calls to the AWS Services the credentials must be configured for the the Amazon SDK. In order to access SQS service we can configure access key and secret key using yaml or properties files</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">cloud:</span></span><br><span class="line"><span class="attr">  aws:</span></span><br><span class="line"><span class="attr">    region:</span></span><br><span class="line"><span class="attr">      static:</span> <span class="string">us-east-1</span></span><br><span class="line"><span class="attr">      auto:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">    credentials:</span></span><br><span class="line"><span class="attr">      access-key:</span> <span class="string">XXXX</span></span><br><span class="line"><span class="attr">      secret-key:</span> <span class="string">XXXX</span></span><br><span class="line"><span class="attr">    end-point:</span></span><br><span class="line"><span class="attr">      uri:</span> <span class="attr">https://sqs.us-east-1.amazonaws.com/549485575026/spring-boot-poc</span></span><br></pre></td></tr></table></figure></p>
<p><strong>Sending message to SQS.</strong></p>
<p>In order to send messages to SQS queue, Spring boot provides <code>QueueMessagingTemplate</code> which uses <code>AmazonSQSAsync</code><br><figure class="highlight java"><figcaption><span>Configuration for QueueMessagingTemplate</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SQSConfig</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;cloud.aws.region.static&#125;"</span>)</span><br><span class="line">    <span class="keyword">private</span> String region;</span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;cloud.aws.credentials.access-key&#125;"</span>)</span><br><span class="line">    <span class="keyword">private</span> String accessKey;</span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;cloud.aws.credentials.secret-key&#125;"</span>)</span><br><span class="line">    <span class="keyword">private</span> String secretKey;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> QueueMessagingTemplate <span class="title">queueMessagingTemplate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> QueueMessagingTemplate(amazonSQSAsync());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@Primary</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> AmazonSQSAsync <span class="title">amazonSQSAsync</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> AmazonSQSAsyncClientBuilder.standard().withRegion(Regions.US_EAST_1)</span><br><span class="line">                .withCredentials(<span class="keyword">new</span> AWSStaticCredentialsProvider(<span class="keyword">new</span> BasicAWSCredentials(accessKey, secretKey)))</span><br><span class="line">                .build();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><code>QueueMessagingTemplate</code> Provides a convenient method <code>convertAndSend</code> which can be used to send domain objects as message. <code>QueueMessagingTemplate</code> delegate the conversion process to an instance of the MessageConverter interface. This interface defines a simple contract to convert between Java objects and SQS messages.<br><figure class="highlight java"><figcaption><span>Message Publisher</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Publisher</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> QueueMessagingTemplate queueMessagingTemplate;</span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;cloud.aws.end-point.uri&#125;"</span>)</span><br><span class="line">    <span class="keyword">private</span> String endpoint;</span><br><span class="line">    <span class="meta">@Scheduled</span>(fixedRate = <span class="number">1000</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">scheduleFixedRateTask</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        log.info(<span class="string">"Sending Message to SQS "</span>);</span><br><span class="line">        <span class="comment">//queueMessagingTemplate.send(endpoint, MessageBuilder.withPayload("Niraj").build());</span></span><br><span class="line">        queueMessagingTemplate.convertAndSend(endpoint, <span class="keyword">new</span> Pojo(<span class="string">"SomeRandomValue"</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>   </p>
<p><strong>Consuming Messages from SQS</strong></p>
<p>Spring boot provides a convenient Annotation <code>@SqsListener</code>. In below example a queue listener container is started that polls the spring-boot-poc queue. The incoming messages is converted to the type of method argument, in this case <code>Pojo</code>.</p>
<p>As the <code>deletionPolicy</code> is provided as <code>ON_SUCCESS</code> it means, Message will be Deleted from Queue only when successfully executed by listener method (no exception thrown). We can set the <strong>Global deletion policy</strong>  for all the  queues which are consumed by<br>SqsListener by using property  <code>cloud.aws.sqs.handler.default-deletion-policy=ON_SUCCESS</code><br><figure class="highlight java"><figcaption><span>Message Consumer</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Consumer</span> </span>&#123;</span><br><span class="line">    <span class="meta">@SqsListener</span>(value = <span class="string">"spring-boot-poc"</span>,deletionPolicy = SqsMessageDeletionPolicy.ON_SUCCESS)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">processMessage</span><span class="params">(Pojo message)</span> </span>&#123;</span><br><span class="line">        log.info(<span class="string">"Message from SQS &#123;&#125;"</span>, message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>   </p>
<p>Note:<br>On application startup, you might see exception related to Metadata or RegistryFactoryBean. You need to exclude some auto configuration. You can find more details<br><a href="https://stackoverflow.com/a/67409356/320087" target="_blank" rel="noopener">https://stackoverflow.com/a/67409356/320087</a><br><figure class="highlight yaml"><figcaption><span>exclude autoconfigure</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> </span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">  autoconfigure:</span></span><br><span class="line"><span class="attr">    exclude:</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">org.springframework.cloud.aws.autoconfigure.context.ContextInstanceDataAutoConfiguration</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">org.springframework.cloud.aws.autoconfigure.context.ContextStackAutoConfiguration</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">org.springframework.cloud.aws.autoconfigure.context.ContextRegionProviderAutoConfiguration</span></span><br></pre></td></tr></table></figure></p>
<p><strong>The code for this post is available on Github <a href="https://github.com/nirajsonawane/aws-sqs-spring-boot-poc.git" target="_blank" rel="noopener">here</a></strong></p>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

    <a data-url="https://nirajsonawane.github.io/2021/05/09/Spring-Boot-with-AWS-sqs/" data-id="clgjbmp1a001mrnusn6dxcwfd" class="article-share-link"><i class="fas fa-share"></i>Share</a>
<script>
    (function ($) {
        // Prevent duplicate binding
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fab fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fab fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fab fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fab fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

            
    
        <a href="https://nirajsonawane.github.io/2021/05/09/Spring-Boot-with-AWS-sqs/#comments" class="article-comment-link disqus-comment-count" data-disqus-url="https://nirajsonawane.github.io/2021/05/09/Spring-Boot-with-AWS-sqs/">Comments</a>
    

        </footer>
    </div>
    
</article>



    <article id="post-spring-boot-with-hibernate-envers" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2021/04/25/spring-boot-with-hibernate-envers/">Spring Boot With Hibernate Envers</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fas fa-calendar-alt"></i>
        <a href="/2021/04/25/spring-boot-with-hibernate-envers/">
            <time datetime="2021-04-25T19:30:36.000Z" itemprop="datePublished">2021-04-25</time>
        </a>
    </div>


                        
                        
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link" href="/tags/Hibernate-Envers/">Hibernate Envers</a>, <a class="tag-link" href="/tags/JPA/">JPA</a>, <a class="tag-link" href="/tags/Spring-Boot/">Spring Boot</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <p><strong>Hibernate Envers</strong> provides an easy &amp; flexible way to implement database auditing and versioning. Database Auditing in the context of JPA means tracking and logging the changes on persisted entities. The database audit logs are important from compliance perspectives and also provides grate helps to identify how and what data has been changed. </p>
<p><strong>Hibernate Envers can be integrated very easyly with Spring Boot JPA.</strong> </p>
<p><strong>The code for this post is available on Github <a href="https://github.com/nirajsonawane/spring-boot-hibernate-envers-demo.git" target="_blank" rel="noopener">here</a></strong></p>
<p>To use Envers in Spring boot application, We need to add below dependency.<br><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&lt;dependency&gt;</span></span><br><span class="line">    <span class="string">&lt;groupId&gt;org.hibernate&lt;/groupId&gt;</span></span><br><span class="line">    <span class="string">&lt;artifactId&gt;hibernate-envers&lt;/artifactId&gt;</span></span><br><span class="line">    <span class="string">&lt;version&gt;5.4.30.Final&lt;/version&gt;</span></span><br><span class="line"><span class="string">&lt;/dependency&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>To Audit changes that are performed on an entity, we need to add <strong>@Audited</strong> annotation on the entity.<br><figure class="highlight java"><figcaption><span>Considering we have a UserDetails entity,for which we want to enable Auditing.</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Audited</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDetails</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="keyword">private</span> Integer userId;</span><br><span class="line">    <span class="keyword">private</span> String firstName;</span><br><span class="line">    <span class="keyword">private</span> String lastName;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>In order to log all the changes to entity, Envers needs <strong>REVINFO</strong> and  <strong>Entity_aud table</strong>, In  this case it will be USER_DETAILS_AUD.<br>The  REVINFO table contains revision id and revision timestamp. A row is inserted into this table on each new revision, that is, on each commit of a transaction, which changes audited data.<br><figure class="highlight sql"><figcaption><span>flyway migration scripts for the the audit table and revinfo table will look like below.</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> REVINFO (</span><br><span class="line">    REV <span class="built_in">INTEGER</span> <span class="keyword">GENERATED</span> <span class="keyword">BY</span> <span class="keyword">DEFAULT</span> <span class="keyword">AS</span> <span class="keyword">IDENTITY</span>,</span><br><span class="line">    REVTSTMP <span class="built_in">BIGINT</span>,</span><br><span class="line">    PRIMARY <span class="keyword">KEY</span> (REV)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> USER_DETAILS (</span><br><span class="line">    USER_ID <span class="built_in">INTEGER</span> PRIMARY <span class="keyword">KEY</span>,</span><br><span class="line">    FIRST_NAME <span class="built_in">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    LAST_NAME <span class="built_in">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span></span><br><span class="line"> );</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> USER_DETAILS_AUD (</span><br><span class="line">    USER_ID <span class="built_in">INTEGER</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    FIRST_NAME <span class="built_in">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">    LAST_NAME <span class="built_in">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">    REV <span class="built_in">INTEGER</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    REVTYPE <span class="built_in">INTEGER</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    PRIMARY <span class="keyword">KEY</span> (USER_ID, REV)</span><br><span class="line">);</span><br></pre></td></tr></table></figure></p>
<p>Now when we insert,update and delete UserDetails entity, audit log will be saved in USER_DETAILS_AUD table.  </p>
<figure class="highlight java"><figcaption><span>for below code we should expect 4 rows in USER_DETAILS_AUD table</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">dataSetup</span><span class="params">(UserDetailsRepository userRepository)</span> </span>&#123;</span><br><span class="line">    UserDetails userDetails = <span class="keyword">new</span> UserDetails(<span class="number">1</span>, <span class="string">"NIRAJ"</span>, <span class="string">"SONAWANE"</span>);</span><br><span class="line">    userRepository.save(userDetails);  <span class="comment">// Create</span></span><br><span class="line"></span><br><span class="line">    userDetails.setFirstName(<span class="string">"Updated Name"</span>);</span><br><span class="line">    userRepository.save(userDetails); <span class="comment">// Update-1</span></span><br><span class="line"></span><br><span class="line">    userDetails.setLastName(<span class="string">"Updated Last name"</span>); <span class="comment">// Update-2</span></span><br><span class="line">    userRepository.save(userDetails);</span><br><span class="line"></span><br><span class="line">    userRepository.delete(userDetails); <span class="comment">// Delete</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<img src="/2021/04/25/spring-boot-with-hibernate-envers/1.png">
<p>The <strong>REVTYPE</strong> column value is taken from the <strong>RevisionType</strong> Enum. Which has values<br><strong>0-Add</strong><br><strong>1-Update</strong><br><strong>2-Delete</strong></p>
<p><strong>The code for this post is available on Github <a href="https://github.com/nirajsonawane/spring-boot-hibernate-envers-demo.git" target="_blank" rel="noopener">here</a></strong></p>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

    <a data-url="https://nirajsonawane.github.io/2021/04/25/spring-boot-with-hibernate-envers/" data-id="clgjbmp1e001trnustlrlnyu8" class="article-share-link"><i class="fas fa-share"></i>Share</a>
<script>
    (function ($) {
        // Prevent duplicate binding
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fab fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fab fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fab fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fab fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

            
    
        <a href="https://nirajsonawane.github.io/2021/04/25/spring-boot-with-hibernate-envers/#comments" class="article-comment-link disqus-comment-count" data-disqus-url="https://nirajsonawane.github.io/2021/04/25/spring-boot-with-hibernate-envers/">Comments</a>
    

        </footer>
    </div>
    
</article>



    <article id="post-Contract-Testing-Using-Spring-Cloud-Contract" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2021/02/20/Contract-Testing-Using-Spring-Cloud-Contract/">Consumer Driven Contract Test Using Spring Cloud Contract</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fas fa-calendar-alt"></i>
        <a href="/2021/02/20/Contract-Testing-Using-Spring-Cloud-Contract/">
            <time datetime="2021-02-20T20:00:29.000Z" itemprop="datePublished">2021-02-20</time>
        </a>
    </div>


                        
                        
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link" href="/tags/Contract-Testing/">Contract Testing</a>, <a class="tag-link" href="/tags/Spring-Boot/">Spring Boot</a>, <a class="tag-link" href="/tags/Spring-Cloud-Contract/">Spring Cloud Contract</a>, <a class="tag-link" href="/tags/pact/">pact</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <img src="/2021/02/20/Contract-Testing-Using-Spring-Cloud-Contract/cdct.jpg">
<p><span>Photo by <a href="https://unsplash.com/@beatriz_perez?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" target="_blank" rel="noopener">Beatriz Pérez Moya</a> on <a href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" target="_blank" rel="noopener">Unsplash</a></span></p>
<p>This post discusses, What is Consumer Driven Contract test? and How to implement it using Spring Cloud Contract.</p>
<p>The code for this post is available on Github <a href="https://gith§ub.com/nirajsonawane/consumer-driven-contract-testing-demo" target="_blank" rel="noopener">here</a></p>
<h3 id="Contract-Testing"><a href="#Contract-Testing" class="headerlink" title="Contract Testing"></a>Contract Testing</h3><p>Contract test are set of automated test, That verifies two separate services are adhering to predefine contracts and are compatible with each other.<br>Aim of contract test is to make sure that, Contract are always kept up to date and each service ( Provider &amp; Consumer) can be tested independently.</p>
<h3 id="Consumer-Driven-Contract-test"><a href="#Consumer-Driven-Contract-test" class="headerlink" title="Consumer Driven Contract test"></a>Consumer Driven Contract test</h3><p>In consumer driven contract testing, Consumers are responsible for providing the contract details. In this strategy consumers of API are at the heart of API design process.In consumer driven API design process providers are forced to complete their consumer obligations. Frameworks like pact and Spring Cloud Contracts provides set of tools to implement Consumer Driven Contract test.</p>
<h3 id="Spring-Cloud-Contract"><a href="#Spring-Cloud-Contract" class="headerlink" title="Spring Cloud Contract"></a>Spring Cloud Contract</h3><p>Spring Cloud Contract provides set of tool for implementing Consumer Driven Contract test for Spring based applications. It has two major component Contract Verifier for Producers &amp; Stub Runner for consumer</p>
<h3 id="Sample-application"><a href="#Sample-application" class="headerlink" title="Sample application"></a>Sample application</h3><p>Let’s write some contract test. Assume we got an requirement from <strong>Consumer application Service-A</strong>  for status API for <strong>Provider  application Service-B</strong>, Which will provide Current Status of user.</p>
<p>In consumer driven contract strategy, as consumer of service, consumers need to define what exactly they want from producer in the form of written contracts. You can provide contract in groovy or yaml format</p>
<h4 id="Provider-Service-B"><a href="#Provider-Service-B" class="headerlink" title="Provider : Service-B"></a>Provider : Service-B</h4><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.cloud.contract.spec.Contract</span><br><span class="line">Contract.make &#123;</span><br><span class="line">    description <span class="string">"should return user status"</span></span><br><span class="line"></span><br><span class="line">    request &#123;</span><br><span class="line">        url <span class="string">"/status"</span></span><br><span class="line">        method GET()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    response &#123;</span><br><span class="line">        status OK()</span><br><span class="line">        headers &#123;</span><br><span class="line">            contentType applicationJson()</span><br><span class="line">        &#125;</span><br><span class="line">        body (</span><br><span class="line"><span class="symbol">                id:</span> <span class="number">1</span>,</span><br><span class="line"><span class="symbol">                status:</span> <span class="string">"CREATED"</span></span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight kotlin"><figcaption><span>Implement Contract</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserStatusController</span></span>(<span class="keyword">private</span> <span class="keyword">val</span> userStatusService: UserStatusService) &#123;</span><br><span class="line">    <span class="meta">@GetMapping(<span class="meta-string">"/status"</span>)</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">getStatus</span><span class="params">()</span></span>: ResponseEntity&lt;UserStatus&gt; &#123;</span><br><span class="line">        <span class="keyword">return</span> ResponseEntity.ok(userStatusService.getUserStatus(<span class="number">1</span>))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">UserStatus</span></span>(<span class="keyword">val</span> id: <span class="built_in">Int</span>, <span class="keyword">val</span> status: String)</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserStatusService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">getUserStatus</span><span class="params">(userId:<span class="type">Int</span>)</span></span>:UserStatus&#123;</span><br><span class="line">        <span class="keyword">return</span> UserStatus(<span class="number">1</span>,<span class="string">"ACTIVATED"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>How to verify contracts ?</strong><br><code>spring-cloud-starter-contract-verifier</code> helps us to automatically verify the contracts, It’s generates the test cases during the build phase and verify the API response against the contract. Add below dependency in pom </p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&lt;dependency&gt;</span></span><br><span class="line">	<span class="string">&lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span></span><br><span class="line">	<span class="string">&lt;artifactId&gt;spring-cloud-starter-contract-verifier&lt;/artifactId&gt;</span></span><br><span class="line">	<span class="string">&lt;scope&gt;test&lt;/scope&gt;</span></span><br><span class="line"><span class="string">&lt;/dependency&gt;</span></span><br></pre></td></tr></table></figure>
<p>To auto-generated tests classes, Add below plugin inside build tag.<br><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&lt;plugin&gt;</span></span><br><span class="line">    <span class="string">&lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span></span><br><span class="line">    <span class="string">&lt;artifactId&gt;spring-cloud-contract-maven-plugin&lt;/artifactId&gt;</span></span><br><span class="line">    <span class="string">&lt;version&gt;3.0.1&lt;/version&gt;</span></span><br><span class="line">    <span class="string">&lt;extensions&gt;true&lt;/extensions&gt;</span></span><br><span class="line">    <span class="string">&lt;configuration&gt;</span></span><br><span class="line">        <span class="string">&lt;testFramework&gt;JUNIT5&lt;/testFramework&gt;</span></span><br><span class="line">        <span class="string">&lt;baseClassForTests&gt;com.ns.producer.BaseClass&lt;/baseClassForTests&gt;</span></span><br><span class="line">    <span class="string">&lt;/configuration&gt;</span></span><br><span class="line"><span class="string">&lt;/plugin&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>We also need to provide <strong>BaseClassForTest</strong>, which will be extended by all generated classes. Base class is responsible for providing all needed mocking &amp; spring beans needed for the generated test classes.In out cases this is how base class will look like.</p>
<figure class="highlight java"><figcaption><span>BaseClass</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span>(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT)</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">BaseClass</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserStatusController userStatusController;</span><br><span class="line">    <span class="meta">@MockBean</span></span><br><span class="line">    <span class="keyword">private</span> UserStatusService userStatusService;</span><br><span class="line">    <span class="meta">@BeforeEach</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Mockito.when(userStatusService.getUserStatus(<span class="number">1</span>)).thenReturn(<span class="keyword">new</span> UserStatus(<span class="number">1</span>, <span class="string">"CREATED"</span>));</span><br><span class="line">        RestAssuredMockMvc.standaloneSetup(userStatusController);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Now if we run the build, <code>ContractVerifierTest</code> test class will be generated inside /target/generated-test-source/contract  generated class will be look like below </p>
<figure class="highlight java"><figcaption><span>Generated Test Class</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ContractVerifierTest</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">validate_get_status_by_id</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		<span class="comment">// given:</span></span><br><span class="line">			MockMvcRequestSpecification request = given();</span><br><span class="line">		<span class="comment">// when:</span></span><br><span class="line">			ResponseOptions response = given().spec(request)</span><br><span class="line">					.get(<span class="string">"/status"</span>);</span><br><span class="line">		<span class="comment">// then:</span></span><br><span class="line">			assertThat(response.statusCode()).isEqualTo(<span class="number">200</span>);</span><br><span class="line">			assertThat(response.header(<span class="string">"Content-Type"</span>)).matches(<span class="string">"application/json.*"</span>);</span><br><span class="line">		<span class="comment">// and:</span></span><br><span class="line">			DocumentContext parsedJson = JsonPath.parse(response.getBody().asString());</span><br><span class="line">			assertThatJson(parsedJson).field(<span class="string">"['id']"</span>).isEqualTo(<span class="number">1</span>);</span><br><span class="line">			assertThatJson(parsedJson).field(<span class="string">"['status']"</span>).isEqualTo(<span class="string">"CREATED"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Consumer-Service-A"><a href="#Consumer-Service-A" class="headerlink" title="Consumer : Service-A"></a>Consumer : Service-A</h4><p>On the consumer side , We can use stub generated by Producer application to test the interaction from consumer to producer.To use stub generated by producer add below dependancy in consumer</p>
<figure class="highlight yaml"><figcaption><span>pom</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&lt;dependency&gt;</span></span><br><span class="line">    <span class="string">&lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span></span><br><span class="line">    <span class="string">&lt;artifactId&gt;spring-cloud-starter-contract-stub-runner&lt;/artifactId&gt;</span></span><br><span class="line">    <span class="string">&lt;scope&gt;test&lt;/scope&gt;</span></span><br><span class="line"><span class="string">&lt;/dependency&gt;</span></span><br></pre></td></tr></table></figure>
<p>the Unit test to test  interaction with Producer will look like below<br><figure class="highlight java"><figcaption><span>pom</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StatusServiceTests</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    lateinit var underTest: StatusService</span><br><span class="line"></span><br><span class="line">    <span class="meta">@JvmField</span></span><br><span class="line">    <span class="meta">@RegisterExtension</span></span><br><span class="line">    <span class="keyword">final</span> val stubRunner = StubRunnerExtension()</span><br><span class="line">        .downloadStub(<span class="string">"com.ns"</span>, <span class="string">"producer"</span>, <span class="string">"0.0.1-SNAPSHOT"</span>, <span class="string">"stubs"</span>)</span><br><span class="line">        .withPort(<span class="number">8080</span>)</span><br><span class="line">        .stubsMode(StubRunnerProperties.StubsMode.LOCAL)</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function">fun <span class="title">getStatus</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        val status = underTest.getStatus()</span><br><span class="line">        assertEquals(status, <span class="string">"CREATED"</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function">fun <span class="title">getPactStatus</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        val status = underTest.getPactStatus()</span><br><span class="line">        assertEquals(status, <span class="string">"CREATED"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>The code for this post is available on Github <a href="https://github.com/nirajsonawane/consumer-driven-contract-testing-demo" target="_blank" rel="noopener">here</a></p>
<p>Reference <a href="https://docs.spring.io/spring-cloud-contract/docs/current/reference/html/index.html" target="_blank" rel="noopener">Spring Cloud Contract Reference Documentation</a>  </p>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

    <a data-url="https://nirajsonawane.github.io/2021/02/20/Contract-Testing-Using-Spring-Cloud-Contract/" data-id="clgjbmp0r000crnusx4ix4xvi" class="article-share-link"><i class="fas fa-share"></i>Share</a>
<script>
    (function ($) {
        // Prevent duplicate binding
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fab fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fab fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fab fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fab fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

            
    
        <a href="https://nirajsonawane.github.io/2021/02/20/Contract-Testing-Using-Spring-Cloud-Contract/#comments" class="article-comment-link disqus-comment-count" data-disqus-url="https://nirajsonawane.github.io/2021/02/20/Contract-Testing-Using-Spring-Cloud-Contract/">Comments</a>
    

        </footer>
    </div>
    
</article>



    <article id="post-Monitoring-Spring-Boot-Application-with-Prometheus-and-Grafana-on-Kubernetes" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2020/05/17/Monitoring-Spring-Boot-Application-with-Prometheus-and-Grafana-on-Kubernetes/">Monitoring Spring Boot Application with Prometheus and Grafana on Kubernetes</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fas fa-calendar-alt"></i>
        <a href="/2020/05/17/Monitoring-Spring-Boot-Application-with-Prometheus-and-Grafana-on-Kubernetes/">
            <time datetime="2020-05-17T17:37:36.000Z" itemprop="datePublished">2020-05-17</time>
        </a>
    </div>


                        
                        
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link" href="/tags/Grafana/">Grafana</a>, <a class="tag-link" href="/tags/Helm/">Helm</a>, <a class="tag-link" href="/tags/Prometheus/">Prometheus</a>, <a class="tag-link" href="/tags/Spring-Boot/">Spring Boot</a>, <a class="tag-link" href="/tags/kubernetes/">kubernetes</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <img src="/2020/05/17/Monitoring-Spring-Boot-Application-with-Prometheus-and-Grafana-on-Kubernetes/helm.jpg">
<p><a style="background-color:black;color:white;text-decoration:none;padding:4px 6px;font-family:-apple-system, BlinkMacSystemFont, &quot;San Francisco&quot;, &quot;Helvetica Neue&quot;, Helvetica, Ubuntu, Roboto, Noto, &quot;Segoe UI&quot;, Arial, sans-serif;font-size:12px;font-weight:bold;line-height:1.2;display:inline-block;border-radius:3px" href="https://unsplash.com/@kmuza?utm_medium=referral&amp;utm_campaign=photographer-credit&amp;utm_content=creditBadge" target="_blank" rel="noopener noreferrer" title="Download free do whatever you want high-resolution photos from Carlos Muza"><span style="display:inline-block;padding:2px 3px"><svg xmlns="http://www.w3.org/2000/svg" style="height:12px;width:auto;position:relative;vertical-align:middle;top:-2px;fill:white" viewbox="0 0 32 32"><title>unsplash-logo</title><path d="M10 9V0h12v9H10zm12 5h10v18H0V14h10v9h12v-9z"/></svg></span><span style="display:inline-block;padding:2px 3px">Carlos Muza</span></a></p>
<p>Welcome to the second post on Prometheus &amp; Grafana. In last post <a href="/2020/05/03/monitoring-spring-boot-application-with-prometheus-and-grafana/" title="Monitoring Spring Boot Application with Prometheus and Grafana">Monitoring Spring Boot Application with Prometheus and Grafana</a> we Integrated <strong>Prometheus</strong> , <strong>Spring Boot</strong> and <strong>Grafana</strong> using docker. </p>
<p>In this post we will discuss, How to setup <strong>Prometheus</strong> and <strong>Grafana</strong> on <strong>Kubernetes</strong> using <strong>Helm Charts</strong></p>
<p>The code for this post is available on Github <a href="https://github.com/nirajsonawane/spring-boot-prometheus-grafana-kubernetes" target="_blank" rel="noopener">here</a></p>
<p>If you’re new to Kubernetes &amp; Prometheus I recommend reading the following hands-on guide on Kubernetes.</p>
<ol>
<li><a href="/2020/04/25/Deploy-React-Spring-Boot-MongoDB-Fullstack-application-on-Kubernetes/" title="Deploy React, Spring Boot & MongoDB Fullstack application on Kubernetes">Deploy React, Spring Boot & MongoDB Fullstack application on Kubernetes</a></li>
<li><a href="/2020/05/03/monitoring-spring-boot-application-with-prometheus-and-grafana/" title="Monitoring Spring Boot Application with Prometheus and Grafana">Monitoring Spring Boot Application with Prometheus and Grafana</a>
</li>
</ol>
<h4 id="Prerequisites"><a href="#Prerequisites" class="headerlink" title="Prerequisites"></a>Prerequisites</h4><p>You need to have <a href="https://kubernetes.io/docs/reference/kubectl/kubectl/" target="_blank" rel="noopener">Kubectl</a>, <a href="https://helm.sh/" target="_blank" rel="noopener">Helm</a>, <a href="https://kubernetes.io/docs/tutorials/hello-minikube/" target="_blank" rel="noopener">Minikube</a> installed on your machine. To Follow along this post, Basic knowledge of Kubernetes is needed.</p>
<h4 id="Step-1-Deploy-a-Spring-Boot-application-on-Kubernetes-and-expose-actuator-endpoints"><a href="#Step-1-Deploy-a-Spring-Boot-application-on-Kubernetes-and-expose-actuator-endpoints" class="headerlink" title="Step 1 : Deploy a Spring Boot application on Kubernetes and expose actuator endpoints"></a>Step 1 : Deploy a Spring Boot application on Kubernetes and expose actuator endpoints</h4><ol>
<li>How to deploy Spring boot application on Kubernetes is explained in detail <a href="https://nirajsonawane.github.io/2020/04/25/Deploy-React-Spring-Boot-MongoDB-Fullstack-application-on-Kubernetes/">here</a> </li>
<li>How to expose actuator endpoints for Prometheus is explained <a href="https://nirajsonawane.github.io/2020/05/03/monitoring-spring-boot-application-with-prometheus-and-grafana/">here</a>. </li>
</ol>
<p>In Kubernetes environment , we can configure <strong>annotations</strong> which will be used by prometheus to scrap data.Below is the complete deployment.yaml file</p>
<figure class="highlight yaml"><figcaption><span>spring-boot-prometheus-deployment.yaml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Deployment</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line"><span class="attr">  name:</span> <span class="string">spring-boot-prometheus</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line"><span class="attr">  selector:</span></span><br><span class="line"><span class="attr">    matchLabels:</span></span><br><span class="line"><span class="attr">      app:</span> <span class="string">spring-boot-prometheus</span></span><br><span class="line"><span class="attr">  replicas:</span> <span class="number">1</span></span><br><span class="line"><span class="attr">  template:</span></span><br><span class="line"><span class="attr">    metadata:</span></span><br><span class="line"><span class="attr">      labels:</span></span><br><span class="line"><span class="attr">        app:</span> <span class="string">spring-boot-prometheus</span></span><br><span class="line"><span class="attr">      annotations:</span></span><br><span class="line">        <span class="string">prometheus.io/scrape:</span> <span class="string">"true"</span></span><br><span class="line">        <span class="string">prometheus.io/port:</span> <span class="string">"8080"</span></span><br><span class="line">        <span class="string">prometheus.io/path:</span> <span class="string">"/actuator/prometheus"</span></span><br><span class="line"><span class="attr">    spec:</span></span><br><span class="line"><span class="attr">      containers:</span></span><br><span class="line"><span class="attr">        - name:</span> <span class="string">spring-boot-prometheus</span></span><br><span class="line"><span class="attr">          image:</span> <span class="string">nirajsonawane/spring-boot-prometheus:0.0.1-SNAPSHOT</span></span><br><span class="line"><span class="attr">          imagePullPolicy:</span> <span class="string">Always</span></span><br><span class="line"><span class="attr">          ports:</span></span><br><span class="line"><span class="attr">            - containerPort:</span> <span class="number">8080</span></span><br><span class="line"><span class="attr">          resources:</span></span><br><span class="line"><span class="attr">            limits:</span></span><br><span class="line"><span class="attr">              memory:</span> <span class="number">294</span><span class="string">Mi</span></span><br></pre></td></tr></table></figure>
<h4 id="Step-2-Create-separate-namespace-for-Monitoring"><a href="#Step-2-Create-separate-namespace-for-Monitoring" class="headerlink" title="Step 2 : Create separate namespace for Monitoring"></a>Step 2 : Create separate namespace for Monitoring</h4><p>it’s always good idea to keep related things together, We will create separate namespace in Kubernetes for monitoring and will deploy all monitoring related application under that namespace.<br><figure class="highlight yaml"><figcaption><span>namespace.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">kind:</span> <span class="string">Namespace</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line"><span class="attr">  name:</span> <span class="string">monitoring</span></span><br></pre></td></tr></table></figure></p>
<h4 id="Helm-Chart"><a href="#Helm-Chart" class="headerlink" title="Helm Chart"></a>Helm Chart</h4><p>Helm uses a packaging format called charts. A chart is a collection of files that describe a related set of Kubernetes resources. A single chart might be used to deploy something simple, like a memcached pod, or something complex, like a full web app stack with HTTP servers, databases, caches, and so on.<br>Charts are created as files laid out in a particular directory tree, then they can be packaged into versioned archives to be deployed.</p>
<h4 id="Step-3-Deploy-Prometheus-using-Helm-Chart"><a href="#Step-3-Deploy-Prometheus-using-Helm-Chart" class="headerlink" title="Step 3: Deploy Prometheus using Helm Chart"></a>Step 3: Deploy Prometheus using Helm Chart</h4><p>With the help of Helm,  We can deploy prometheus using single command.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">helm install prometheus stable/prometheus --namespace monitoring</span><br></pre></td></tr></table></figure><br>This will deploy Prometheus into your cluster in the monitoring namespace and mark the release with the name prometheus.</p>
<img src="/2020/05/17/Monitoring-Spring-Boot-Application-with-Prometheus-and-Grafana-on-Kubernetes/prometheus.PNG">
<p>let’s check if prometheus is running or not<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl get pods -n monitoring </span><br></pre></td></tr></table></figure><br><img src="/2020/05/17/Monitoring-Spring-Boot-Application-with-Prometheus-and-Grafana-on-Kubernetes/prometheus-get.PNG"></p>
<h4 id="Step-4-Deploy-Grafana-using-Helm-Chart"><a href="#Step-4-Deploy-Grafana-using-Helm-Chart" class="headerlink" title="Step 4: Deploy Grafana using Helm Chart"></a>Step 4: Deploy Grafana using Helm Chart</h4><p>In Previous post we have manually created the data sources. Here we can create the  <strong>config map for Prometheus data source</strong> and   grafana deployment can use these config maps.</p>
<p>After Grafana Helm chart deployment, it looks for any config maps that contain a grafana_datasource label.</p>
<figure class="highlight yaml"><figcaption><span>config.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">ConfigMap</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line"><span class="attr">  name:</span> <span class="string">prometheus-grafana-datasource</span></span><br><span class="line"><span class="attr">  namespace:</span> <span class="string">monitoring</span></span><br><span class="line"><span class="attr">  labels:</span></span><br><span class="line"><span class="attr">    grafana_datasource:</span> <span class="string">'1'</span></span><br><span class="line"><span class="attr">data:</span></span><br><span class="line">  <span class="string">datasource.yaml:</span> <span class="string">|-</span></span><br><span class="line"><span class="attr">    apiVersion:</span> <span class="number">1</span></span><br><span class="line"><span class="attr">    datasources:</span></span><br><span class="line"><span class="attr">    - name:</span> <span class="string">Prometheus</span></span><br><span class="line"><span class="attr">      type:</span> <span class="string">prometheus</span></span><br><span class="line"><span class="attr">      access:</span> <span class="string">proxy</span></span><br><span class="line"><span class="attr">      orgId:</span> <span class="number">1</span></span><br><span class="line"><span class="attr">      url:</span> <span class="attr">http://prometheus-server.monitoring.svc.cluster.local</span></span><br></pre></td></tr></table></figure>
<figure class="highlight yaml"><figcaption><span>values.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">sidecar:</span></span><br><span class="line"><span class="attr">  image:</span> <span class="string">xuxinkun/k8s-sidecar:0.0.7</span></span><br><span class="line"><span class="attr">  imagePullPolicy:</span> <span class="string">IfNotPresent</span></span><br><span class="line"><span class="attr">  datasources:</span></span><br><span class="line"><span class="attr">    enabled:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">    label:</span> <span class="string">grafana_datasource</span></span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><figcaption><span>Config map & Grafana deployment</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kubectl apply -f helm/monitoring/grafana/config.yml </span><br><span class="line">helm install grafana stable/grafana -f helm/monitoring/grafana/values.yml --namespace monitoring  </span><br></pre></td></tr></table></figure>
<img src="/2020/05/17/Monitoring-Spring-Boot-Application-with-Prometheus-and-Grafana-on-Kubernetes/graphana.PNG">
<p>Password protected Grafana instance will be be deployed, To know the password run the below command.<br><figure class="highlight plain"><figcaption><span>print password</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl get secret --namespace monitoring grafana -o jsonpath=&quot;&#123;.data.admin-password&#125;&quot; | base64 --decode ; echo</span><br></pre></td></tr></table></figure><br>Now let’s do port-forward for accessing grafana<br><figure class="highlight plain"><figcaption><span>port-forward deployment</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl --namespace monitoring port-forward grafana-5c6bbf7f4c-n5pqb 3000</span><br></pre></td></tr></table></figure></p>
<p>Now if you goto <a href="http://localhost:3000" target="_blank" rel="noopener">http://localhost:3000</a> grafana interface will be available.<br><img src="/2020/05/17/Monitoring-Spring-Boot-Application-with-Prometheus-and-Grafana-on-Kubernetes/graphana-web.PNG"></p>
<p>Now lets add JVM chart which wil be using our Prometheus datasource.<br><img src="/2020/05/17/Monitoring-Spring-Boot-Application-with-Prometheus-and-Grafana-on-Kubernetes/graphana-JVM.PNG"></p>
<p>The code for this post is available on Github <a href="https://github.com/nirajsonawane/spring-boot-prometheus-grafana-kubernetes" target="_blank" rel="noopener">here</a></p>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

    <a data-url="https://nirajsonawane.github.io/2020/05/17/Monitoring-Spring-Boot-Application-with-Prometheus-and-Grafana-on-Kubernetes/" data-id="clgjbmp11000xrnusgy48vbcq" class="article-share-link"><i class="fas fa-share"></i>Share</a>
<script>
    (function ($) {
        // Prevent duplicate binding
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fab fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fab fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fab fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fab fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

            
    
        <a href="https://nirajsonawane.github.io/2020/05/17/Monitoring-Spring-Boot-Application-with-Prometheus-and-Grafana-on-Kubernetes/#comments" class="article-comment-link disqus-comment-count" data-disqus-url="https://nirajsonawane.github.io/2020/05/17/Monitoring-Spring-Boot-Application-with-Prometheus-and-Grafana-on-Kubernetes/">Comments</a>
    

        </footer>
    </div>
    
</article>



    <nav id="page-nav">
        <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
    </nav>
</section>
            
                
<aside id="sidebar">
   
        
    <div class="widget-wrap">
        <h3 class="widget-title">recent</h3>
        <div class="widget">
            <ul id="recent-post" class="">
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2023/04/16/From-Monolith-to-Microservices-A-Gradual-Approach-with-Modular-Monolithic-Architecture/" class="thumbnail">
    
    

    
        <span style="background-image:url(/asset/Moduler.png)" alt="From Monolith to Microservices: A Gradual Approach with Modular Monolithic Architecture" class="thumbnail-image"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"></p>
                            <p class="item-title"><a href="/2023/04/16/From-Monolith-to-Microservices-A-Gradual-Approach-with-Modular-Monolithic-Architecture/" class="title">From Monolith to Microservices: A Gradual Approach with Modular Monolithic Architecture</a></p>
                            <p class="item-date"><time datetime="2023-04-16T11:25:47.000Z" itemprop="datePublished">2023-04-16</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2023/04/09/Launching-Spring-Boot-Apps-on-AWS-ECS-Fargate/" class="thumbnail">
    
    

    
        <span style="background-image:url(/asset/amazon_ecs-ar21.svg)" alt="Launching Spring Boot Apps on AWS ECS Fargate" class="thumbnail-image"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"></p>
                            <p class="item-title"><a href="/2023/04/09/Launching-Spring-Boot-Apps-on-AWS-ECS-Fargate/" class="title">Launching Spring Boot Apps on AWS ECS Fargate</a></p>
                            <p class="item-date"><time datetime="2023-04-09T19:06:22.000Z" itemprop="datePublished">2023-04-09</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2022/04/27/Spring-Boot-AWS-RDS-Part-3-Secrets-Manager/" class="thumbnail">
    
    

    
        <span style="background-image:url(/asset/aws-rds-logo-png-transparent.png)" alt="Spring Boot &amp; AWS RDS Part 3- Secrets-Manager" class="thumbnail-image"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"></p>
                            <p class="item-title"><a href="/2022/04/27/Spring-Boot-AWS-RDS-Part-3-Secrets-Manager/" class="title">Spring Boot &amp; AWS RDS Part 3- Secrets-Manager</a></p>
                            <p class="item-date"><time datetime="2022-04-27T19:40:50.000Z" itemprop="datePublished">2022-04-27</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2022/04/24/Spring-Boot-AWS-RDS-Read-Replica-Part-2/" class="thumbnail">
    
    

    
        <span style="background-image:url(/asset/aws-rds-logo-png-transparent.png)" alt="Spring Boot &amp; AWS RDS Part 2 - Read Replicas" class="thumbnail-image"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"></p>
                            <p class="item-title"><a href="/2022/04/24/Spring-Boot-AWS-RDS-Read-Replica-Part-2/" class="title">Spring Boot &amp; AWS RDS Part 2 - Read Replicas</a></p>
                            <p class="item-date"><time datetime="2022-04-24T10:14:14.000Z" itemprop="datePublished">2022-04-24</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2022/04/18/Spring-Boot-AWS-RDS/" class="thumbnail">
    
    

    
        <span style="background-image:url(/asset/aws-rds-logo-png-transparent.png)" alt="Spring Boot &amp; AWS RDS - Part 1" class="thumbnail-image"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"></p>
                            <p class="item-title"><a href="/2022/04/18/Spring-Boot-AWS-RDS/" class="title">Spring Boot &amp; AWS RDS - Part 1</a></p>
                            <p class="item-date"><time datetime="2022-04-18T09:56:34.000Z" itemprop="datePublished">2022-04-18</time></p>
                        </div>
                    </li>
                
            </ul>
        </div>
    </div>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title">tag cloud</h3>
        <div class="widget tagcloud">
            <a href="/tags/AOP/" style="font-size: 10px;">AOP</a> <a href="/tags/AWS/" style="font-size: 16.25px;">AWS</a> <a href="/tags/Angular6/" style="font-size: 11.25px;">Angular6</a> <a href="/tags/Bigdecimal/" style="font-size: 10px;">Bigdecimal</a> <a href="/tags/Cloud-Bus/" style="font-size: 10px;">Cloud Bus</a> <a href="/tags/Cloud-Config/" style="font-size: 10px;">Cloud Config</a> <a href="/tags/Collector/" style="font-size: 10px;">Collector</a> <a href="/tags/Comparator/" style="font-size: 11.25px;">Comparator</a> <a href="/tags/Concurrency/" style="font-size: 17.5px;">Concurrency</a> <a href="/tags/Contract-Testing/" style="font-size: 10px;">Contract Testing</a> <a href="/tags/Docker/" style="font-size: 11.25px;">Docker</a> <a href="/tags/ECR/" style="font-size: 10px;">ECR</a> <a href="/tags/ECS/" style="font-size: 10px;">ECS</a> <a href="/tags/Eureka/" style="font-size: 10px;">Eureka</a> <a href="/tags/FARGATE/" style="font-size: 10px;">FARGATE</a> <a href="/tags/Filter/" style="font-size: 10px;">Filter</a> <a href="/tags/Functional-Programming/" style="font-size: 10px;">Functional Programming</a> <a href="/tags/Grafana/" style="font-size: 11.25px;">Grafana</a> <a href="/tags/Helm/" style="font-size: 10px;">Helm</a> <a href="/tags/Hibernate-Envers/" style="font-size: 10px;">Hibernate Envers</a> <a href="/tags/JPA/" style="font-size: 10px;">JPA</a> <a href="/tags/JUnit-5/" style="font-size: 10px;">JUnit-5</a> <a href="/tags/JWT/" style="font-size: 10px;">JWT</a> <a href="/tags/Java/" style="font-size: 20px;">Java</a> <a href="/tags/Java-8/" style="font-size: 20px;">Java-8</a> <a href="/tags/Java-9/" style="font-size: 13.75px;">Java-9</a> <a href="/tags/Kotlin/" style="font-size: 10px;">Kotlin</a> <a href="/tags/Kotlin-Types/" style="font-size: 10px;">Kotlin Types</a> <a href="/tags/Kubernetes/" style="font-size: 10px;">Kubernetes</a> <a href="/tags/Map/" style="font-size: 13.75px;">Map</a> <a href="/tags/Material/" style="font-size: 10px;">Material</a> <a href="/tags/Microservice/" style="font-size: 16.25px;">Microservice</a> <a href="/tags/Minikube/" style="font-size: 10px;">Minikube</a> <a href="/tags/MongoDB/" style="font-size: 10px;">MongoDB</a> <a href="/tags/Mongodb/" style="font-size: 11.25px;">Mongodb</a> <a href="/tags/Multithreading/" style="font-size: 17.5px;">Multithreading</a> <a href="/tags/Navigation/" style="font-size: 10px;">Navigation</a> <a href="/tags/OpenFeign/" style="font-size: 10px;">OpenFeign</a> <a href="/tags/Optional/" style="font-size: 10px;">Optional</a> <a href="/tags/Pipes/" style="font-size: 10px;">Pipes</a> <a href="/tags/PostgreSQL/" style="font-size: 12.5px;">PostgreSQL</a> <a href="/tags/Project-Reactor/" style="font-size: 12.5px;">Project Reactor</a> <a href="/tags/Prometheus/" style="font-size: 11.25px;">Prometheus</a> <a href="/tags/RDS/" style="font-size: 12.5px;">RDS</a> <a href="/tags/RXjava/" style="font-size: 10px;">RXjava</a> <a href="/tags/React/" style="font-size: 10px;">React</a> <a href="/tags/Reactive-Programming/" style="font-size: 13.75px;">Reactive Programming</a> <a href="/tags/ReactiveX/" style="font-size: 10px;">ReactiveX</a> <a href="/tags/ReadReplica/" style="font-size: 11.25px;">ReadReplica</a> <a href="/tags/Rest/" style="font-size: 10px;">Rest</a> <a href="/tags/Ribbon/" style="font-size: 10px;">Ribbon</a> <a href="/tags/Routing/" style="font-size: 10px;">Routing</a> <a href="/tags/S3/" style="font-size: 10px;">S3</a> <a href="/tags/SQS/" style="font-size: 10px;">SQS</a> <a href="/tags/SecretsManager/" style="font-size: 10px;">SecretsManager</a> <a href="/tags/Smart-Casts/" style="font-size: 10px;">Smart Casts</a> <a href="/tags/Sorting/" style="font-size: 13.75px;">Sorting</a> <a href="/tags/Spring/" style="font-size: 10px;">Spring</a> <a href="/tags/Spring-Boot/" style="font-size: 18.75px;">Spring Boot</a> <a href="/tags/Spring-Boot-Admin/" style="font-size: 10px;">Spring Boot Admin</a> <a href="/tags/Spring-Boot-Starter/" style="font-size: 10px;">Spring Boot Starter</a> <a href="/tags/Spring-Cloud/" style="font-size: 15px;">Spring Cloud</a> <a href="/tags/Spring-Cloud-Contract/" style="font-size: 10px;">Spring Cloud Contract</a> <a href="/tags/Spring-Security/" style="font-size: 10px;">Spring Security</a> <a href="/tags/Spring-Batch/" style="font-size: 10px;">Spring-Batch</a> <a href="/tags/Stream/" style="font-size: 13.75px;">Stream</a> <a href="/tags/Streams/" style="font-size: 10px;">Streams</a> <a href="/tags/Summary-Statistics/" style="font-size: 10px;">Summary Statistics</a> <a href="/tags/Swagger/" style="font-size: 10px;">Swagger</a> <a href="/tags/Unit-Testing/" style="font-size: 10px;">Unit Testing</a> <a href="/tags/WebFlux/" style="font-size: 12.5px;">WebFlux</a> <a href="/tags/architecture/" style="font-size: 10px;">architecture</a> <a href="/tags/containers/" style="font-size: 10px;">containers</a> <a href="/tags/kubernetes/" style="font-size: 10px;">kubernetes</a> <a href="/tags/microservice/" style="font-size: 10px;">microservice</a> <a href="/tags/modular-monolithic/" style="font-size: 10px;">modular monolithic</a> <a href="/tags/monolithic/" style="font-size: 10px;">monolithic</a> <a href="/tags/pact/" style="font-size: 10px;">pact</a> <a href="/tags/testcontainers/" style="font-size: 10px;">testcontainers</a>
        </div>
    </div>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title">archives</h3>
        <div class="widget">
            <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/04/">April 2023</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/04/">April 2022</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">May 2021</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">April 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">May 2020</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">April 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">September 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">June 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a><span class="archive-list-count">16</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a><span class="archive-list-count">9</span></li></ul>
        </div>
    </div>

    
        
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">links</h3>
        <div class="widget">
            <ul>
                
                    <li>
                        <a href="https://stackoverflow.com/users/320087/niraj-sonawane?tab=profile">StackOverflow</a>
                    </li>
                
                    <li>
                        <a href="https://nirajsonawane.github.io/portfolio/">Portfolio</a>
                    </li>
                
            </ul>
        </div>
    </div>


    
    <div id="toTop" class="fas fa-angle-up"></div>
</aside>

            
        </div>
        <footer id="footer">
    <div class="outer">
        <div id="footer-info" class="inner">
            &copy; 2023 Niraj Sonawane<br>
            Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>. Theme by <a href="http://github.com/ppoffice">PPOffice</a>
        </div>
    </div>
</footer>
        
    
    <script>
    var disqus_config = function () {
        
        this.page.identifier = '';
    };
    (function() { 
        var d = document, s = d.createElement('script');  
        s.src = '//' + 'https-nirajsonawane-github-io-1' + '.disqus.com/count.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>




    
        <script src="/libs/lightgallery/js/lightgallery.min.js"></script>
        <script src="/libs/lightgallery/js/lg-thumbnail.min.js"></script>
        <script src="/libs/lightgallery/js/lg-pager.min.js"></script>
        <script src="/libs/lightgallery/js/lg-autoplay.min.js"></script>
        <script src="/libs/lightgallery/js/lg-fullscreen.min.js"></script>
        <script src="/libs/lightgallery/js/lg-zoom.min.js"></script>
        <script src="/libs/lightgallery/js/lg-hash.min.js"></script>
        <script src="/libs/lightgallery/js/lg-share.min.js"></script>
        <script src="/libs/lightgallery/js/lg-video.min.js"></script>
    
    
        <script src="/libs/justified-gallery/jquery.justifiedGallery.min.js"></script>
    
    



<!-- Custom Scripts -->
<script src="/js/main.js"></script>

    </div>
</body>
</html>